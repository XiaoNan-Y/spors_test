{"remainingRequest":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestScores.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestScores.vue","mtime":1742395302054},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\babel-loader\\lib\\index.js","mtime":1741946991478},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js","mtime":1741947007540}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCB7IGdldFRlc3RSZWNvcmRzLCBzdWJtaXRUZXN0UmVjb3JkIH0gZnJvbSAnQC9hcGkvc3R1ZGVudCcKaW1wb3J0IHsgZ2V0U3BvcnRzSXRlbXMgfSBmcm9tICdAL2FwaS9jb21tb24nCmltcG9ydCB7IGZvcm1hdERhdGUgfSBmcm9tICdAL3V0aWxzL2RhdGUnCmltcG9ydCBQYWdpbmF0aW9uIGZyb20gJ0AvY29tcG9uZW50cy9QYWdpbmF0aW9uJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdHVkZW50VGVzdFNjb3JlcycsCiAgY29tcG9uZW50czogeyBQYWdpbmF0aW9uIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICAvLyDmn6Xor6Llj4LmlbAKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIHNpemU6IDEwLAogICAgICAgIHNwb3J0c0l0ZW1JZDogdW5kZWZpbmVkLAogICAgICAgIHN0YXR1czogdW5kZWZpbmVkCiAgICAgIH0sCiAgICAgIC8vIOaIkOe7qeWIl+ihqAogICAgICBzY29yZUxpc3Q6IFtdLAogICAgICAvLyDmgLvorrDlvZXmlbAKICAgICAgdG90YWw6IDAsCiAgICAgIC8vIOS9k+iCsumhueebruWIl+ihqAogICAgICBzcG9ydHNJdGVtczogW10sCiAgICAgIC8vIOaPkOS6pOWvueivneahhgogICAgICBzdWJtaXREaWFsb2c6IHsKICAgICAgICB2aXNpYmxlOiBmYWxzZQogICAgICB9LAogICAgICAvLyDmj5DkuqTooajljZUKICAgICAgc3VibWl0Rm9ybTogewogICAgICAgIHNwb3J0c0l0ZW1JZDogdW5kZWZpbmVkLAogICAgICAgIHNjb3JlOiB1bmRlZmluZWQKICAgICAgfSwKICAgICAgLy8g6KGo5Y2V5qCh6aqM6KeE5YiZCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgc3BvcnRzSXRlbUlkOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oup5rWL6K+V6aG555uuJywgdHJpZ2dlcjogJ2NoYW5nZScgfQogICAgICAgIF0sCiAgICAgICAgc2NvcmU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaXmiJDnu6knLCB0cmlnZ2VyOiAnYmx1cicgfQogICAgICAgIF0KICAgICAgfSwKICAgICAgLy8g6K+m5oOF5a+56K+d5qGGCiAgICAgIGRldGFpbERpYWxvZzogewogICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgIGRhdGE6IHt9CiAgICAgIH0KICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldFNwb3J0c0l0ZW1zKCkKICAgIHRoaXMuZ2V0TGlzdCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBmb3JtYXREYXRlLAogICAgLy8g6I635Y+W5L2T6IKy6aG555uu5YiX6KGoCiAgICBhc3luYyBnZXRTcG9ydHNJdGVtcygpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRTcG9ydHNJdGVtcygpCiAgICAgICAgdGhpcy5zcG9ydHNJdGVtcyA9IHJlcy5kYXRhLmRhdGEKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bkvZPogrLpobnnm67lpLHotKU6JywgZXJyb3IpCiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6I635Y+W5L2T6IKy6aG555uu5aSx6LSlJykKICAgICAgfQogICAgfSwKICAgIC8vIOiOt+WPluaIkOe7qeWIl+ihqAogICAgYXN5bmMgZ2V0TGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBnZXRUZXN0UmVjb3Jkcyh7CiAgICAgICAgICBwYWdlOiB0aGlzLnF1ZXJ5UGFyYW1zLnBhZ2UgLSAxLCAvLyDliY3nq6/pobXnoIHku44x5byA5aeL77yM5ZCO56uv5LuOMOW8gOWniwogICAgICAgICAgc2l6ZTogdGhpcy5xdWVyeVBhcmFtcy5zaXplLAogICAgICAgICAgc3BvcnRzSXRlbUlkOiB0aGlzLnF1ZXJ5UGFyYW1zLnNwb3J0c0l0ZW1JZCwKICAgICAgICAgIHN0YXR1czogdGhpcy5xdWVyeVBhcmFtcy5zdGF0dXMKICAgICAgICB9KTsKICAgICAgICAKICAgICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2U6JywgcmVzKTsgLy8g5re75Yqg6LCD6K+V5pel5b+XCiAgICAgICAgCiAgICAgICAgaWYgKHJlcy5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuc2NvcmVMaXN0ID0gcmVzLmRhdGEuY29udGVudDsKICAgICAgICAgIHRoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbEVsZW1lbnRzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IocmVzLm1zZyB8fCAn6I635Y+W5pWw5o2u5aSx6LSlJyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ+iOt+WPluaIkOe7qeWIl+ihqOWksei0pTonLCBlcnJvcik7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcign6I635Y+W5oiQ57up5YiX6KGo5aSx6LSlOiAnICsgZXJyb3IubWVzc2FnZSk7CiAgICAgIH0KICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICB9LAogICAgLy8g5p+l6K+i5oyJ6ZKu54K55Ye7CiAgICBoYW5kbGVRdWVyeSgpIHsKICAgICAgdGhpcy5xdWVyeVBhcmFtcy5wYWdlID0gMQogICAgICB0aGlzLmdldExpc3QoKQogICAgfSwKICAgIC8vIOmHjee9ruaMiemSrueCueWHuwogICAgcmVzZXRRdWVyeSgpIHsKICAgICAgdGhpcy5xdWVyeVBhcmFtcyA9IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIHNpemU6IDEwLAogICAgICAgIHNwb3J0c0l0ZW1JZDogdW5kZWZpbmVkLAogICAgICAgIHN0YXR1czogdW5kZWZpbmVkCiAgICAgIH0KICAgICAgdGhpcy5nZXRMaXN0KCkKICAgIH0sCiAgICAvLyDmj5DkuqTmiJDnu6nmjInpkq7ngrnlh7sKICAgIGhhbmRsZVN1Ym1pdFNjb3JlKCkgewogICAgICB0aGlzLnN1Ym1pdEZvcm0gPSB7CiAgICAgICAgc3BvcnRzSXRlbUlkOiB1bmRlZmluZWQsCiAgICAgICAgc2NvcmU6IHVuZGVmaW5lZAogICAgICB9CiAgICAgIHRoaXMuc3VibWl0RGlhbG9nLnZpc2libGUgPSB0cnVlCiAgICB9LAogICAgLy8g5o+Q5Lqk5oiQ57upCiAgICBzdWJtaXRTY29yZSgpIHsKICAgICAgdGhpcy4kcmVmcy5zdWJtaXRGb3JtLnZhbGlkYXRlKGFzeW5jIHZhbGlkID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGF3YWl0IHN1Ym1pdFRlc3RSZWNvcmQodGhpcy5zdWJtaXRGb3JtKQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ+aPkOS6pOaIkOWKnycpCiAgICAgICAgICAgIHRoaXMuc3VibWl0RGlhbG9nLnZpc2libGUgPSBmYWxzZQogICAgICAgICAgICB0aGlzLmdldExpc3QoKQogICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcign5o+Q5Lqk5oiQ57up5aSx6LSlOicsIGVycm9yKQogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmj5DkuqTmiJDnu6nlpLHotKUnKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDmn6XnnIvor6bmg4UKICAgIGhhbmRsZURldGFpbChyb3cpIHsKICAgICAgdGhpcy5kZXRhaWxEaWFsb2cuZGF0YSA9IHJvdwogICAgICB0aGlzLmRldGFpbERpYWxvZy52aXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIC8vIOiOt+WPlueKtuaAgeexu+WeiwogICAgZ2V0U3RhdHVzVHlwZShzdGF0dXMpIHsKICAgICAgY29uc3Qgc3RhdHVzTWFwID0gewogICAgICAgIFBFTkRJTkc6ICd3YXJuaW5nJywKICAgICAgICBBUFBST1ZFRDogJ3N1Y2Nlc3MnLAogICAgICAgIFJFSkVDVEVEOiAnZGFuZ2VyJwogICAgICB9CiAgICAgIHJldHVybiBzdGF0dXNNYXBbc3RhdHVzXSB8fCAnaW5mbycKICAgIH0sCiAgICAvLyDojrflj5bnirbmgIHmlofmnKwKICAgIGdldFN0YXR1c1RleHQoc3RhdHVzKSB7CiAgICAgIGNvbnN0IHN0YXR1c01hcCA9IHsKICAgICAgICBQRU5ESU5HOiAn5b6F5a6h5qC4JywKICAgICAgICBBUFBST1ZFRDogJ+W3sumAmui/hycsCiAgICAgICAgUkVKRUNURUQ6ICflt7LpqbPlm54nCiAgICAgIH0KICAgICAgcmV0dXJuIHN0YXR1c01hcFtzdGF0dXNdIHx8IHN0YXR1cwogICAgfQogIH0KfQo="},{"version":3,"sources":["TestScores.vue"],"names":[],"mappings":";AAmIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"TestScores.vue","sourceRoot":"src/views/student","sourcesContent":["<template>\n  <div class=\"test-scores\">\n    <el-card class=\"box-card\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>体测成绩</span>\n        <el-button \n          type=\"primary\" \n          size=\"small\" \n          style=\"float: right; margin-left: 10px;\"\n          @click=\"handleSubmitScore\"\n        >\n          提交成绩\n        </el-button>\n      </div>\n\n      <!-- 搜索表单 -->\n      <el-form :inline=\"true\" :model=\"queryParams\" class=\"search-form\">\n        <el-form-item label=\"测试项目\">\n          <el-select v-model=\"queryParams.sportsItemId\" placeholder=\"请选择\" clearable>\n            <el-option\n              v-for=\"item in sportsItems\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            />\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"状态\">\n          <el-select v-model=\"queryParams.status\" placeholder=\"请选择\" clearable>\n            <el-option label=\"待审核\" value=\"PENDING\" />\n            <el-option label=\"已通过\" value=\"APPROVED\" />\n            <el-option label=\"已驳回\" value=\"REJECTED\" />\n          </el-select>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"handleQuery\">查询</el-button>\n          <el-button @click=\"resetQuery\">重置</el-button>\n        </el-form-item>\n      </el-form>\n\n      <!-- 成绩列表 -->\n      <el-table\n        v-loading=\"loading\"\n        :data=\"scoreList\"\n        style=\"width: 100%\"\n      >\n        <el-table-column label=\"测试项目\" prop=\"sportsItem.name\" />\n        <el-table-column label=\"成绩\" prop=\"score\" />\n        <el-table-column label=\"状态\">\n          <template slot-scope=\"scope\">\n            <el-tag :type=\"getStatusType(scope.row.status)\">\n              {{ getStatusText(scope.row.status) }}\n            </el-tag>\n          </template>\n        </el-table-column>\n        <el-table-column label=\"提交时间\" prop=\"createdAt\">\n          <template slot-scope=\"scope\">\n            {{ formatDate(scope.row.createdAt) }}\n          </template>\n        </el-table-column>\n        <el-table-column label=\"审核意见\" prop=\"reviewComment\" />\n        <el-table-column label=\"操作\" width=\"150\">\n          <template slot-scope=\"scope\">\n            <el-button\n              size=\"mini\"\n              type=\"text\"\n              @click=\"handleDetail(scope.row)\"\n            >\n              详情\n            </el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <!-- 分页 -->\n      <pagination\n        v-show=\"total > 0\"\n        :total=\"total\"\n        :page.sync=\"queryParams.page\"\n        :limit.sync=\"queryParams.size\"\n        @pagination=\"getList\"\n      />\n\n      <!-- 提交成绩对话框 -->\n      <el-dialog :title=\"'提交体测成绩'\" :visible.sync=\"submitDialog.visible\" width=\"500px\">\n        <el-form ref=\"submitForm\" :model=\"submitForm\" :rules=\"rules\" label-width=\"80px\">\n          <el-form-item label=\"测试项目\" prop=\"sportsItemId\">\n            <el-select v-model=\"submitForm.sportsItemId\" placeholder=\"请选择测试项目\">\n              <el-option\n                v-for=\"item in sportsItems\"\n                :key=\"item.id\"\n                :label=\"item.name\"\n                :value=\"item.id\"\n              />\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"成绩\" prop=\"score\">\n            <el-input-number \n              v-model=\"submitForm.score\" \n              :precision=\"2\" \n              :step=\"0.1\" \n              :min=\"0\"\n            />\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"submitDialog.visible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"submitScore\">确 定</el-button>\n        </div>\n      </el-dialog>\n\n      <!-- 详情对话框 -->\n      <el-dialog title=\"成绩详情\" :visible.sync=\"detailDialog.visible\" width=\"600px\">\n        <el-descriptions :column=\"2\" border>\n          <el-descriptions-item label=\"测试项目\">{{ detailDialog.data.sportsItem?.name }}</el-descriptions-item>\n          <el-descriptions-item label=\"成绩\">{{ detailDialog.data.score }}</el-descriptions-item>\n          <el-descriptions-item label=\"状态\">\n            <el-tag :type=\"getStatusType(detailDialog.data.status)\">\n              {{ getStatusText(detailDialog.data.status) }}\n            </el-tag>\n          </el-descriptions-item>\n          <el-descriptions-item label=\"提交时间\">{{ formatDate(detailDialog.data.createdAt) }}</el-descriptions-item>\n          <el-descriptions-item label=\"审核时间\" :span=\"2\">{{ formatDate(detailDialog.data.reviewTime) }}</el-descriptions-item>\n          <el-descriptions-item label=\"审核意见\" :span=\"2\">{{ detailDialog.data.reviewComment || '无' }}</el-descriptions-item>\n        </el-descriptions>\n      </el-dialog>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport { getTestRecords, submitTestRecord } from '@/api/student'\nimport { getSportsItems } from '@/api/common'\nimport { formatDate } from '@/utils/date'\nimport Pagination from '@/components/Pagination'\n\nexport default {\n  name: 'StudentTestScores',\n  components: { Pagination },\n  data() {\n    return {\n      loading: false,\n      // 查询参数\n      queryParams: {\n        page: 1,\n        size: 10,\n        sportsItemId: undefined,\n        status: undefined\n      },\n      // 成绩列表\n      scoreList: [],\n      // 总记录数\n      total: 0,\n      // 体育项目列表\n      sportsItems: [],\n      // 提交对话框\n      submitDialog: {\n        visible: false\n      },\n      // 提交表单\n      submitForm: {\n        sportsItemId: undefined,\n        score: undefined\n      },\n      // 表单校验规则\n      rules: {\n        sportsItemId: [\n          { required: true, message: '请选择测试项目', trigger: 'change' }\n        ],\n        score: [\n          { required: true, message: '请输入成绩', trigger: 'blur' }\n        ]\n      },\n      // 详情对话框\n      detailDialog: {\n        visible: false,\n        data: {}\n      }\n    }\n  },\n  created() {\n    this.getSportsItems()\n    this.getList()\n  },\n  methods: {\n    formatDate,\n    // 获取体育项目列表\n    async getSportsItems() {\n      try {\n        const res = await getSportsItems()\n        this.sportsItems = res.data.data\n      } catch (error) {\n        console.error('获取体育项目失败:', error)\n        this.$message.error('获取体育项目失败')\n      }\n    },\n    // 获取成绩列表\n    async getList() {\n      this.loading = true;\n      try {\n        const res = await getTestRecords({\n          page: this.queryParams.page - 1, // 前端页码从1开始，后端从0开始\n          size: this.queryParams.size,\n          sportsItemId: this.queryParams.sportsItemId,\n          status: this.queryParams.status\n        });\n        \n        console.log('Response:', res); // 添加调试日志\n        \n        if (res.code === 200) {\n          this.scoreList = res.data.content;\n          this.total = res.data.totalElements;\n        } else {\n          throw new Error(res.msg || '获取数据失败');\n        }\n      } catch (error) {\n        console.error('获取成绩列表失败:', error);\n        this.$message.error('获取成绩列表失败: ' + error.message);\n      }\n      this.loading = false;\n    },\n    // 查询按钮点击\n    handleQuery() {\n      this.queryParams.page = 1\n      this.getList()\n    },\n    // 重置按钮点击\n    resetQuery() {\n      this.queryParams = {\n        page: 1,\n        size: 10,\n        sportsItemId: undefined,\n        status: undefined\n      }\n      this.getList()\n    },\n    // 提交成绩按钮点击\n    handleSubmitScore() {\n      this.submitForm = {\n        sportsItemId: undefined,\n        score: undefined\n      }\n      this.submitDialog.visible = true\n    },\n    // 提交成绩\n    submitScore() {\n      this.$refs.submitForm.validate(async valid => {\n        if (valid) {\n          try {\n            await submitTestRecord(this.submitForm)\n            this.$message.success('提交成功')\n            this.submitDialog.visible = false\n            this.getList()\n          } catch (error) {\n            console.error('提交成绩失败:', error)\n            this.$message.error('提交成绩失败')\n          }\n        }\n      })\n    },\n    // 查看详情\n    handleDetail(row) {\n      this.detailDialog.data = row\n      this.detailDialog.visible = true\n    },\n    // 获取状态类型\n    getStatusType(status) {\n      const statusMap = {\n        PENDING: 'warning',\n        APPROVED: 'success',\n        REJECTED: 'danger'\n      }\n      return statusMap[status] || 'info'\n    },\n    // 获取状态文本\n    getStatusText(status) {\n      const statusMap = {\n        PENDING: '待审核',\n        APPROVED: '已通过',\n        REJECTED: '已驳回'\n      }\n      return statusMap[status] || status\n    }\n  }\n}\n</script>\n\n<style scoped>\n.test-scores {\n  padding: 20px;\n}\n.search-form {\n  margin-bottom: 20px;\n}\n</style> "]}]}