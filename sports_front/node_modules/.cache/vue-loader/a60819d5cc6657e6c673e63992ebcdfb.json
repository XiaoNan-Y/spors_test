{"remainingRequest":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestRecord.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestRecord.vue","mtime":1742351775605},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\babel-loader\\lib\\index.js","mtime":1741946991478},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js","mtime":1741947007540}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgeyBmb3JtYXREYXRlVGltZSB9IGZyb20gJ0AvdXRpbHMvZGF0ZXRpbWUnDQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ1Rlc3RSZWNvcmQnLA0KDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHNwb3J0c0l0ZW06IHt9LA0KICAgICAgcmVjb3JkRm9ybTogew0KICAgICAgICBzY29yZTogbnVsbCwNCiAgICAgICAgcmVtYXJrOiAnJw0KICAgICAgfSwNCiAgICAgIHJ1bGVzOiB7DQogICAgICAgIHNjb3JlOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpea1i+ivleaIkOe7qScsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgIHsgdHlwZTogJ251bWJlcicsIG1lc3NhZ2U6ICfmiJDnu6nlv4XpobvkuLrmlbDlrZcnLCB0cmlnZ2VyOiAnYmx1cicgfQ0KICAgICAgICBdDQogICAgICB9LA0KICAgICAgaGlzdG9yeVJlY29yZHM6IFtdDQogICAgfQ0KICB9LA0KDQogIGNyZWF0ZWQoKSB7DQogICAgdGhpcy5mZXRjaFNwb3J0c0l0ZW0oKQ0KICAgIHRoaXMuZmV0Y2hIaXN0b3J5UmVjb3JkcygpDQogIH0sDQoNCiAgbWV0aG9kczogew0KICAgIGZvcm1hdERhdGVUaW1lLA0KDQogICAgYXN5bmMgZmV0Y2hTcG9ydHNJdGVtKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQNCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRodHRwLmdldChgL2FwaS9zdHVkZW50L3Rlc3QtaXRlbXMvJHtpZH1gKQ0KICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09PSAyMDApIHsNCiAgICAgICAgICB0aGlzLnNwb3J0c0l0ZW0gPSByZXNwb25zZS5kYXRhLmRhdGENCiAgICAgICAgfQ0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W6aG555uu5L+h5oGv5aSx6LSlOicsIGVycm9yKQ0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfojrflj5bpobnnm67kv6Hmga/lpLHotKUnKQ0KICAgICAgfQ0KICAgIH0sDQoNCiAgICBhc3luYyBmZXRjaEhpc3RvcnlSZWNvcmRzKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgY29uc3QgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQNCiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRodHRwLmdldChgL2FwaS9zdHVkZW50L3Rlc3QtcmVjb3Jkcy9oaXN0b3J5LyR7aWR9YCkNCiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMjAwKSB7DQogICAgICAgICAgdGhpcy5oaXN0b3J5UmVjb3JkcyA9IHJlc3BvbnNlLmRhdGEuZGF0YQ0KICAgICAgICB9DQogICAgICB9IGNhdGNoIChlcnJvcikgew0KICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bljoblj7LorrDlvZXlpLHotKU6JywgZXJyb3IpDQogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+iOt+WPluWOhuWPsuiusOW9leWksei0pScpDQogICAgICB9DQogICAgfSwNCg0KICAgIGdldFN0YXR1c1R5cGUoc3RhdHVzKSB7DQogICAgICBpZiAoc3RhdHVzID09PSAnUEFTU0VEJykgcmV0dXJuICdzdWNjZXNzJw0KICAgICAgaWYgKHN0YXR1cyA9PT0gJ0ZBSUxFRCcpIHJldHVybiAnZGFuZ2VyJw0KICAgICAgcmV0dXJuICdpbmZvJw0KICAgIH0sDQoNCiAgICBnZXRTdGF0dXNUZXh0KHN0YXR1cykgew0KICAgICAgaWYgKHN0YXR1cyA9PT0gJ1BBU1NFRCcpIHJldHVybiAn6YCa6L+HJw0KICAgICAgaWYgKHN0YXR1cyA9PT0gJ0ZBSUxFRCcpIHJldHVybiAn5pyq6YCa6L+HJw0KICAgICAgcmV0dXJuICflvoXlrqHmoLgnDQogICAgfSwNCg0KICAgIGFzeW5jIHN1Ym1pdFJlY29yZCgpIHsNCiAgICAgIHRyeSB7DQogICAgICAgIGF3YWl0IHRoaXMuJHJlZnMucmVjb3JkRm9ybS52YWxpZGF0ZSgpDQogICAgICAgIA0KICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCgnL2FwaS9zdHVkZW50L3Rlc3QtcmVjb3JkcycsIHsNCiAgICAgICAgICBzcG9ydHNJdGVtSWQ6IHRoaXMuc3BvcnRzSXRlbS5pZCwNCiAgICAgICAgICBzY29yZTogdGhpcy5yZWNvcmRGb3JtLnNjb3JlLA0KICAgICAgICAgIHJlbWFyazogdGhpcy5yZWNvcmRGb3JtLnJlbWFyaw0KICAgICAgICB9KQ0KDQogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT09IDIwMCkgew0KICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5o+Q5Lqk5oiQ5YqfJykNCiAgICAgICAgICB0aGlzLmZldGNoSGlzdG9yeVJlY29yZHMoKQ0KICAgICAgICAgIHRoaXMucmVjb3JkRm9ybS5zY29yZSA9IG51bGwNCiAgICAgICAgICB0aGlzLnJlY29yZEZvcm0ucmVtYXJrID0gJycNCiAgICAgICAgfQ0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsNCiAgICAgICAgY29uc29sZS5lcnJvcign5o+Q5Lqk5oiQ57up5aSx6LSlOicsIGVycm9yKQ0KICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmj5DkuqTlpLHotKXvvJonICsgKGVycm9yLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlIHx8ICfmnKrnn6XplJnor68nKSkNCiAgICAgIH0NCiAgICB9LA0KDQogICAgZ29CYWNrKCkgew0KICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy9zdHVkZW50L3Rlc3QtaXRlbXMnKQ0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["TestRecord.vue"],"names":[],"mappings":";AA+EA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"TestRecord.vue","sourceRoot":"src/views/student","sourcesContent":["<template>\r\n  <div class=\"test-record\">\r\n    <el-card>\r\n      <div slot=\"header\">\r\n        <span>{{ sportsItem.name }} - 测试记录</span>\r\n      </div>\r\n\r\n      <!-- 项目信息 -->\r\n      <el-descriptions :column=\"2\" border>\r\n        <el-descriptions-item label=\"项目类型\">\r\n          {{ sportsItem.type === 'REQUIRED' ? '必测项目' : '选测项目' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"计量单位\">\r\n          {{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"及格标准\">\r\n          {{ sportsItem.passScore }}{{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"优秀标准\">\r\n          {{ sportsItem.excellentScore }}{{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 成绩录入 -->\r\n      <div class=\"score-input\">\r\n        <el-form :model=\"recordForm\" :rules=\"rules\" ref=\"recordForm\" label-width=\"100px\">\r\n          <el-form-item label=\"测试成绩\" prop=\"score\">\r\n            <el-input-number \r\n              v-model=\"recordForm.score\" \r\n              :precision=\"2\"\r\n              :step=\"0.1\"\r\n              :min=\"0\"\r\n            ></el-input-number>\r\n            <span class=\"unit\">{{ sportsItem.unit }}</span>\r\n          </el-form-item>\r\n          <el-form-item label=\"备注说明\" prop=\"remark\">\r\n            <el-input \r\n              type=\"textarea\" \r\n              v-model=\"recordForm.remark\"\r\n              placeholder=\"请输入备注说明（选填）\"\r\n              :rows=\"3\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"submitRecord\">提交成绩</el-button>\r\n            <el-button @click=\"goBack\">返回</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n\r\n      <!-- 历史记录 -->\r\n      <div class=\"history-records\">\r\n        <div class=\"section-title\">历史记录</div>\r\n        <el-table :data=\"historyRecords\" stripe>\r\n          <el-table-column prop=\"score\" label=\"成绩\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.score }}{{ sportsItem.unit }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"status\" label=\"状态\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              <el-tag :type=\"getStatusType(scope.row.status)\">\r\n                {{ getStatusText(scope.row.status) }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"remark\" label=\"备注\"></el-table-column>\r\n          <el-table-column prop=\"createdAt\" label=\"测试时间\" width=\"180\">\r\n            <template slot-scope=\"scope\">\r\n              {{ formatDateTime(scope.row.createdAt) }}\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { formatDateTime } from '@/utils/datetime'\r\n\r\nexport default {\r\n  name: 'TestRecord',\r\n\r\n  data() {\r\n    return {\r\n      sportsItem: {},\r\n      recordForm: {\r\n        score: null,\r\n        remark: ''\r\n      },\r\n      rules: {\r\n        score: [\r\n          { required: true, message: '请输入测试成绩', trigger: 'blur' },\r\n          { type: 'number', message: '成绩必须为数字', trigger: 'blur' }\r\n        ]\r\n      },\r\n      historyRecords: []\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.fetchSportsItem()\r\n    this.fetchHistoryRecords()\r\n  },\r\n\r\n  methods: {\r\n    formatDateTime,\r\n\r\n    async fetchSportsItem() {\r\n      try {\r\n        const id = this.$route.params.id\r\n        const response = await this.$http.get(`/api/student/test-items/${id}`)\r\n        if (response.data.code === 200) {\r\n          this.sportsItem = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取项目信息失败:', error)\r\n        this.$message.error('获取项目信息失败')\r\n      }\r\n    },\r\n\r\n    async fetchHistoryRecords() {\r\n      try {\r\n        const id = this.$route.params.id\r\n        const response = await this.$http.get(`/api/student/test-records/history/${id}`)\r\n        if (response.data.code === 200) {\r\n          this.historyRecords = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取历史记录失败:', error)\r\n        this.$message.error('获取历史记录失败')\r\n      }\r\n    },\r\n\r\n    getStatusType(status) {\r\n      if (status === 'PASSED') return 'success'\r\n      if (status === 'FAILED') return 'danger'\r\n      return 'info'\r\n    },\r\n\r\n    getStatusText(status) {\r\n      if (status === 'PASSED') return '通过'\r\n      if (status === 'FAILED') return '未通过'\r\n      return '待审核'\r\n    },\r\n\r\n    async submitRecord() {\r\n      try {\r\n        await this.$refs.recordForm.validate()\r\n        \r\n        const response = await this.$http.post('/api/student/test-records', {\r\n          sportsItemId: this.sportsItem.id,\r\n          score: this.recordForm.score,\r\n          remark: this.recordForm.remark\r\n        })\r\n\r\n        if (response.data.code === 200) {\r\n          this.$message.success('提交成功')\r\n          this.fetchHistoryRecords()\r\n          this.recordForm.score = null\r\n          this.recordForm.remark = ''\r\n        }\r\n      } catch (error) {\r\n        console.error('提交成绩失败:', error)\r\n        this.$message.error('提交失败：' + (error.response?.data?.message || '未知错误'))\r\n      }\r\n    },\r\n\r\n    goBack() {\r\n      this.$router.push('/student/test-items')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.test-record {\r\n  padding: 20px;\r\n}\r\n\r\n.score-input {\r\n  margin: 20px 0;\r\n  max-width: 500px;\r\n}\r\n\r\n.unit {\r\n  margin-left: 10px;\r\n  color: #666;\r\n}\r\n\r\n.section-title {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  margin: 20px 0;\r\n  padding-left: 10px;\r\n  border-left: 4px solid #409EFF;\r\n}\r\n\r\n.history-records {\r\n  margin-top: 30px;\r\n}\r\n</style> "]}]}