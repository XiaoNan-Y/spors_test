{"remainingRequest":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\admin\\Profile.vue?vue&type=style&index=0&id=6fd21e9f&lang=scss&scoped=true","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\admin\\Profile.vue","mtime":1742537086827},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1741946995932},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1741947007541},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\postcss-loader\\src\\index.js","mtime":1741947003089},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\sass-loader\\dist\\cjs.js","mtime":1741947006026},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js","mtime":1741947007540}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci5wcm9maWxlIHsKICBwYWRkaW5nOiAyMHB4OwogIAogIC5jYXJkLWhlYWRlciB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgIAogICAgaSB7CiAgICAgIG1hcmdpbi1yaWdodDogOHB4OwogICAgICBmb250LXNpemU6IDE4cHg7CiAgICB9CiAgICAKICAgIHNwYW4gewogICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgIGZvbnQtd2VpZ2h0OiA1MDA7CiAgICB9CiAgfQogIAogIC5wcm9maWxlLWNhcmQsIC5wYXNzd29yZC1jYXJkIHsKICAgIG1hcmdpbi1ib3R0b206IDIwcHg7CiAgICAKICAgIC5lbC1mb3JtIHsKICAgICAgcGFkZGluZzogMjBweDsKICAgIH0KICB9CiAgCiAgLmVsLWlucHV0LmlzLWRpc2FibGVkIC5lbC1pbnB1dF9faW5uZXIgewogICAgY29sb3I6ICM2MDYyNjY7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjVmN2ZhOwogIH0KfQo="},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";AA+KA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views/admin","sourcesContent":["<template>\n  <div class=\"profile\">\n    <el-row :gutter=\"20\">\n      <el-col :span=\"12\">\n        <el-card class=\"profile-card\">\n          <div slot=\"header\" class=\"card-header\">\n            <span><i class=\"el-icon-user\"></i> 个人信息</span>\n          </div>\n          <el-form :model=\"userForm\" :rules=\"rules\" ref=\"userForm\" label-width=\"100px\">\n            <el-form-item label=\"用户名\" prop=\"username\">\n              <el-input v-model=\"userForm.username\" disabled></el-input>\n            </el-form-item>\n            <el-form-item label=\"角色\" prop=\"role\">\n              <el-input v-model=\"userForm.role\" disabled></el-input>\n            </el-form-item>\n            <el-form-item label=\"邮箱\" prop=\"email\">\n              <el-input v-model=\"userForm.email\" placeholder=\"请输入邮箱\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"手机号\" prop=\"phone\">\n              <el-input v-model=\"userForm.phone\" placeholder=\"请输入手机号\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"updateProfile\">保存修改</el-button>\n            </el-form-item>\n          </el-form>\n        </el-card>\n      </el-col>\n      \n      <el-col :span=\"12\">\n        <el-card class=\"password-card\">\n          <div slot=\"header\" class=\"card-header\">\n            <span><i class=\"el-icon-lock\"></i> 修改密码</span>\n          </div>\n          <el-form :model=\"passwordForm\" :rules=\"passwordRules\" ref=\"passwordForm\" label-width=\"100px\">\n            <el-form-item label=\"原密码\" prop=\"oldPassword\">\n              <el-input type=\"password\" v-model=\"passwordForm.oldPassword\" show-password placeholder=\"请输入原密码\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"新密码\" prop=\"newPassword\">\n              <el-input type=\"password\" v-model=\"passwordForm.newPassword\" show-password placeholder=\"请输入新密码\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"确认密码\" prop=\"confirmPassword\">\n              <el-input type=\"password\" v-model=\"passwordForm.confirmPassword\" show-password placeholder=\"请确认新密码\"></el-input>\n            </el-form-item>\n            <el-form-item>\n              <el-button type=\"primary\" @click=\"updatePassword\">修改密码</el-button>\n            </el-form-item>\n          </el-form>\n        </el-card>\n      </el-col>\n    </el-row>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'AdminProfile',\n  data() {\n    const validateConfirmPassword = (rule, value, callback) => {\n      if (value !== this.passwordForm.newPassword) {\n        callback(new Error('两次输入的密码不一致'))\n      } else {\n        callback()\n      }\n    }\n    \n    return {\n      userForm: {\n        username: '',\n        role: '管理员',\n        email: '',\n        phone: ''\n      },\n      passwordForm: {\n        oldPassword: '',\n        newPassword: '',\n        confirmPassword: ''\n      },\n      rules: {\n        email: [\n          { type: 'email', message: '请输入正确的邮箱地址', trigger: 'blur' }\n        ],\n        phone: [\n          { pattern: /^1[3-9]\\d{9}$/, message: '请输入正确的手机号码', trigger: 'blur' }\n        ]\n      },\n      passwordRules: {\n        oldPassword: [\n          { required: true, message: '请输入原密码', trigger: 'blur' },\n          { min: 6, message: '密码长度不能小于6位', trigger: 'blur' }\n        ],\n        newPassword: [\n          { required: true, message: '请输入新密码', trigger: 'blur' },\n          { min: 6, message: '密码长度不能小于6位', trigger: 'blur' }\n        ],\n        confirmPassword: [\n          { required: true, message: '请确认新密码', trigger: 'blur' },\n          { validator: validateConfirmPassword, trigger: 'blur' }\n        ]\n      }\n    }\n  },\n  created() {\n    this.fetchUserInfo()\n  },\n  methods: {\n    async fetchUserInfo() {\n      try {\n        const res = await this.$axios.get('/api/admin/info')\n        if (res.data.code === 200) {\n          const { username, email, phone } = res.data.data\n          this.userForm = {\n            username,\n            role: '管理员',\n            email: email || '',\n            phone: phone || ''\n          }\n        }\n      } catch (error) {\n        this.$message.error('获取用户信息失败')\n        console.error(error)\n      }\n    },\n    async updateProfile() {\n      try {\n        await this.$refs.userForm.validate()\n        const res = await this.$axios.put('/api/admin/profile', {\n          email: this.userForm.email,\n          phone: this.userForm.phone\n        })\n        if (res.data.code === 200) {\n          this.$message.success('个人信息更新成功')\n        }\n      } catch (error) {\n        this.$message.error(error.message || '更新失败')\n      }\n    },\n    async updatePassword() {\n      try {\n        await this.$refs.passwordForm.validate()\n        \n        const loading = this.$loading({\n          lock: true,\n          text: '正在修改密码...',\n          spinner: 'el-icon-loading'\n        })\n        \n        try {\n          const res = await this.$axios.put('/api/admin/password', {\n            oldPassword: this.passwordForm.oldPassword,\n            newPassword: this.passwordForm.newPassword\n          })\n          \n          if (res.data.code === 200) {\n            this.$message.success('密码修改成功，请重新登录')\n            this.$refs.passwordForm.resetFields()\n            setTimeout(() => {\n              localStorage.clear()\n              this.$router.push('/login')\n            }, 1500)\n          } else {\n            this.$message.error(res.data.message || '修改密码失败')\n          }\n        } finally {\n          loading.close()\n        }\n      } catch (error) {\n        console.error('修改密码失败:', error)\n        this.$message.error(error.response?.data?.message || '修改密码失败，请重试')\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.profile {\n  padding: 20px;\n  \n  .card-header {\n    display: flex;\n    align-items: center;\n    \n    i {\n      margin-right: 8px;\n      font-size: 18px;\n    }\n    \n    span {\n      font-size: 16px;\n      font-weight: 500;\n    }\n  }\n  \n  .profile-card, .password-card {\n    margin-bottom: 20px;\n    \n    .el-form {\n      padding: 20px;\n    }\n  }\n  \n  .el-input.is-disabled .el-input__inner {\n    color: #606266;\n    background-color: #f5f7fa;\n  }\n}\n</style> "]}]}