{"remainingRequest":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestRecord.vue?vue&type=style&index=0&id=d49c3fde&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestRecord.vue","mtime":1742351775605},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1741946995932},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1741947007541},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\postcss-loader\\src\\index.js","mtime":1741947003089},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js","mtime":1741947007540}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQoudGVzdC1yZWNvcmQgew0KICBwYWRkaW5nOiAyMHB4Ow0KfQ0KDQouc2NvcmUtaW5wdXQgew0KICBtYXJnaW46IDIwcHggMDsNCiAgbWF4LXdpZHRoOiA1MDBweDsNCn0NCg0KLnVuaXQgew0KICBtYXJnaW4tbGVmdDogMTBweDsNCiAgY29sb3I6ICM2NjY7DQp9DQoNCi5zZWN0aW9uLXRpdGxlIHsNCiAgZm9udC1zaXplOiAxNnB4Ow0KICBmb250LXdlaWdodDogYm9sZDsNCiAgbWFyZ2luOiAyMHB4IDA7DQogIHBhZGRpbmctbGVmdDogMTBweDsNCiAgYm9yZGVyLWxlZnQ6IDRweCBzb2xpZCAjNDA5RUZGOw0KfQ0KDQouaGlzdG9yeS1yZWNvcmRzIHsNCiAgbWFyZ2luLXRvcDogMzBweDsNCn0NCg=="},{"version":3,"sources":["TestRecord.vue"],"names":[],"mappings":";AAiLA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"TestRecord.vue","sourceRoot":"src/views/student","sourcesContent":["<template>\r\n  <div class=\"test-record\">\r\n    <el-card>\r\n      <div slot=\"header\">\r\n        <span>{{ sportsItem.name }} - 测试记录</span>\r\n      </div>\r\n\r\n      <!-- 项目信息 -->\r\n      <el-descriptions :column=\"2\" border>\r\n        <el-descriptions-item label=\"项目类型\">\r\n          {{ sportsItem.type === 'REQUIRED' ? '必测项目' : '选测项目' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"计量单位\">\r\n          {{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"及格标准\">\r\n          {{ sportsItem.passScore }}{{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"优秀标准\">\r\n          {{ sportsItem.excellentScore }}{{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 成绩录入 -->\r\n      <div class=\"score-input\">\r\n        <el-form :model=\"recordForm\" :rules=\"rules\" ref=\"recordForm\" label-width=\"100px\">\r\n          <el-form-item label=\"测试成绩\" prop=\"score\">\r\n            <el-input-number \r\n              v-model=\"recordForm.score\" \r\n              :precision=\"2\"\r\n              :step=\"0.1\"\r\n              :min=\"0\"\r\n            ></el-input-number>\r\n            <span class=\"unit\">{{ sportsItem.unit }}</span>\r\n          </el-form-item>\r\n          <el-form-item label=\"备注说明\" prop=\"remark\">\r\n            <el-input \r\n              type=\"textarea\" \r\n              v-model=\"recordForm.remark\"\r\n              placeholder=\"请输入备注说明（选填）\"\r\n              :rows=\"3\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"submitRecord\">提交成绩</el-button>\r\n            <el-button @click=\"goBack\">返回</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n\r\n      <!-- 历史记录 -->\r\n      <div class=\"history-records\">\r\n        <div class=\"section-title\">历史记录</div>\r\n        <el-table :data=\"historyRecords\" stripe>\r\n          <el-table-column prop=\"score\" label=\"成绩\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.score }}{{ sportsItem.unit }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"status\" label=\"状态\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              <el-tag :type=\"getStatusType(scope.row.status)\">\r\n                {{ getStatusText(scope.row.status) }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"remark\" label=\"备注\"></el-table-column>\r\n          <el-table-column prop=\"createdAt\" label=\"测试时间\" width=\"180\">\r\n            <template slot-scope=\"scope\">\r\n              {{ formatDateTime(scope.row.createdAt) }}\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { formatDateTime } from '@/utils/datetime'\r\n\r\nexport default {\r\n  name: 'TestRecord',\r\n\r\n  data() {\r\n    return {\r\n      sportsItem: {},\r\n      recordForm: {\r\n        score: null,\r\n        remark: ''\r\n      },\r\n      rules: {\r\n        score: [\r\n          { required: true, message: '请输入测试成绩', trigger: 'blur' },\r\n          { type: 'number', message: '成绩必须为数字', trigger: 'blur' }\r\n        ]\r\n      },\r\n      historyRecords: []\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.fetchSportsItem()\r\n    this.fetchHistoryRecords()\r\n  },\r\n\r\n  methods: {\r\n    formatDateTime,\r\n\r\n    async fetchSportsItem() {\r\n      try {\r\n        const id = this.$route.params.id\r\n        const response = await this.$http.get(`/api/student/test-items/${id}`)\r\n        if (response.data.code === 200) {\r\n          this.sportsItem = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取项目信息失败:', error)\r\n        this.$message.error('获取项目信息失败')\r\n      }\r\n    },\r\n\r\n    async fetchHistoryRecords() {\r\n      try {\r\n        const id = this.$route.params.id\r\n        const response = await this.$http.get(`/api/student/test-records/history/${id}`)\r\n        if (response.data.code === 200) {\r\n          this.historyRecords = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取历史记录失败:', error)\r\n        this.$message.error('获取历史记录失败')\r\n      }\r\n    },\r\n\r\n    getStatusType(status) {\r\n      if (status === 'PASSED') return 'success'\r\n      if (status === 'FAILED') return 'danger'\r\n      return 'info'\r\n    },\r\n\r\n    getStatusText(status) {\r\n      if (status === 'PASSED') return '通过'\r\n      if (status === 'FAILED') return '未通过'\r\n      return '待审核'\r\n    },\r\n\r\n    async submitRecord() {\r\n      try {\r\n        await this.$refs.recordForm.validate()\r\n        \r\n        const response = await this.$http.post('/api/student/test-records', {\r\n          sportsItemId: this.sportsItem.id,\r\n          score: this.recordForm.score,\r\n          remark: this.recordForm.remark\r\n        })\r\n\r\n        if (response.data.code === 200) {\r\n          this.$message.success('提交成功')\r\n          this.fetchHistoryRecords()\r\n          this.recordForm.score = null\r\n          this.recordForm.remark = ''\r\n        }\r\n      } catch (error) {\r\n        console.error('提交成绩失败:', error)\r\n        this.$message.error('提交失败：' + (error.response?.data?.message || '未知错误'))\r\n      }\r\n    },\r\n\r\n    goBack() {\r\n      this.$router.push('/student/test-items')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.test-record {\r\n  padding: 20px;\r\n}\r\n\r\n.score-input {\r\n  margin: 20px 0;\r\n  max-width: 500px;\r\n}\r\n\r\n.unit {\r\n  margin-left: 10px;\r\n  color: #666;\r\n}\r\n\r\n.section-title {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  margin: 20px 0;\r\n  padding-left: 10px;\r\n  border-left: 4px solid #409EFF;\r\n}\r\n\r\n.history-records {\r\n  margin-top: 30px;\r\n}\r\n</style> "]}]}