{"remainingRequest":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestRecord.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\src\\views\\student\\TestRecord.vue","mtime":1742351775605},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\babel.config.js","mtime":1741355860000},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\babel-loader\\lib\\index.js","mtime":1741946991478},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1741946992817},{"path":"C:\\Users\\HP\\Desktop\\sports_test\\sports_front\\node_modules\\vue-loader\\lib\\index.js","mtime":1741947007540}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCB7IGZvcm1hdERhdGVUaW1lIH0gZnJvbSAnQC91dGlscy9kYXRldGltZSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnVGVzdFJlY29yZCcsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNwb3J0c0l0ZW06IHt9LAogICAgICByZWNvcmRGb3JtOiB7CiAgICAgICAgc2NvcmU6IG51bGwsCiAgICAgICAgcmVtYXJrOiAnJwogICAgICB9LAogICAgICBydWxlczogewogICAgICAgIHNjb3JlOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5rWL6K+V5oiQ57upJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH0sIHsKICAgICAgICAgIHR5cGU6ICdudW1iZXInLAogICAgICAgICAgbWVzc2FnZTogJ+aIkOe7qeW/hemhu+S4uuaVsOWtlycsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XQogICAgICB9LAogICAgICBoaXN0b3J5UmVjb3JkczogW10KICAgIH07CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5mZXRjaFNwb3J0c0l0ZW0oKTsKICAgIHRoaXMuZmV0Y2hIaXN0b3J5UmVjb3JkcygpOwogIH0sCiAgbWV0aG9kczogewogICAgZm9ybWF0RGF0ZVRpbWUsCiAgICBhc3luYyBmZXRjaFNwb3J0c0l0ZW0oKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRodHRwLmdldChgL2FwaS9zdHVkZW50L3Rlc3QtaXRlbXMvJHtpZH1gKTsKICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuc3BvcnRzSXRlbSA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcign6I635Y+W6aG555uu5L+h5oGv5aSx6LSlOicsIGVycm9yKTsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfojrflj5bpobnnm67kv6Hmga/lpLHotKUnKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGZldGNoSGlzdG9yeVJlY29yZHMoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgaWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMuaWQ7CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLiRodHRwLmdldChgL2FwaS9zdHVkZW50L3Rlc3QtcmVjb3Jkcy9oaXN0b3J5LyR7aWR9YCk7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLmhpc3RvcnlSZWNvcmRzID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCfojrflj5bljoblj7LorrDlvZXlpLHotKU6JywgZXJyb3IpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+iOt+WPluWOhuWPsuiusOW9leWksei0pScpOwogICAgICB9CiAgICB9LAogICAgZ2V0U3RhdHVzVHlwZShzdGF0dXMpIHsKICAgICAgaWYgKHN0YXR1cyA9PT0gJ1BBU1NFRCcpIHJldHVybiAnc3VjY2Vzcyc7CiAgICAgIGlmIChzdGF0dXMgPT09ICdGQUlMRUQnKSByZXR1cm4gJ2Rhbmdlcic7CiAgICAgIHJldHVybiAnaW5mbyc7CiAgICB9LAogICAgZ2V0U3RhdHVzVGV4dChzdGF0dXMpIHsKICAgICAgaWYgKHN0YXR1cyA9PT0gJ1BBU1NFRCcpIHJldHVybiAn6YCa6L+HJzsKICAgICAgaWYgKHN0YXR1cyA9PT0gJ0ZBSUxFRCcpIHJldHVybiAn5pyq6YCa6L+HJzsKICAgICAgcmV0dXJuICflvoXlrqHmoLgnOwogICAgfSwKICAgIGFzeW5jIHN1Ym1pdFJlY29yZCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBhd2FpdCB0aGlzLiRyZWZzLnJlY29yZEZvcm0udmFsaWRhdGUoKTsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCgnL2FwaS9zdHVkZW50L3Rlc3QtcmVjb3JkcycsIHsKICAgICAgICAgIHNwb3J0c0l0ZW1JZDogdGhpcy5zcG9ydHNJdGVtLmlkLAogICAgICAgICAgc2NvcmU6IHRoaXMucmVjb3JkRm9ybS5zY29yZSwKICAgICAgICAgIHJlbWFyazogdGhpcy5yZWNvcmRGb3JtLnJlbWFyawogICAgICAgIH0pOwogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCfmj5DkuqTmiJDlip8nKTsKICAgICAgICAgIHRoaXMuZmV0Y2hIaXN0b3J5UmVjb3JkcygpOwogICAgICAgICAgdGhpcy5yZWNvcmRGb3JtLnNjb3JlID0gbnVsbDsKICAgICAgICAgIHRoaXMucmVjb3JkRm9ybS5yZW1hcmsgPSAnJzsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdmFyIF9lcnJvciRyZXNwb25zZTsKICAgICAgICBjb25zb2xlLmVycm9yKCfmj5DkuqTmiJDnu6nlpLHotKU6JywgZXJyb3IpOwogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ+aPkOS6pOWksei0pe+8micgKyAoKChfZXJyb3IkcmVzcG9uc2UgPSBlcnJvci5yZXNwb25zZSkgPT09IG51bGwgfHwgX2Vycm9yJHJlc3BvbnNlID09PSB2b2lkIDAgfHwgKF9lcnJvciRyZXNwb25zZSA9IF9lcnJvciRyZXNwb25zZS5kYXRhKSA9PT0gbnVsbCB8fCBfZXJyb3IkcmVzcG9uc2UgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9lcnJvciRyZXNwb25zZS5tZXNzYWdlKSB8fCAn5pyq55+l6ZSZ6K+vJykpOwogICAgICB9CiAgICB9LAogICAgZ29CYWNrKCkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnL3N0dWRlbnQvdGVzdC1pdGVtcycpOwogICAgfQogIH0KfTs="},{"version":3,"names":["formatDateTime","name","data","sportsItem","recordForm","score","remark","rules","required","message","trigger","type","historyRecords","created","fetchSportsItem","fetchHistoryRecords","methods","id","$route","params","response","$http","get","code","error","console","$message","getStatusType","status","getStatusText","submitRecord","$refs","validate","post","sportsItemId","success","_error$response","goBack","$router","push"],"sources":["src/views/student/TestRecord.vue"],"sourcesContent":["<template>\r\n  <div class=\"test-record\">\r\n    <el-card>\r\n      <div slot=\"header\">\r\n        <span>{{ sportsItem.name }} - 测试记录</span>\r\n      </div>\r\n\r\n      <!-- 项目信息 -->\r\n      <el-descriptions :column=\"2\" border>\r\n        <el-descriptions-item label=\"项目类型\">\r\n          {{ sportsItem.type === 'REQUIRED' ? '必测项目' : '选测项目' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"计量单位\">\r\n          {{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"及格标准\">\r\n          {{ sportsItem.passScore }}{{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"优秀标准\">\r\n          {{ sportsItem.excellentScore }}{{ sportsItem.unit }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n\r\n      <!-- 成绩录入 -->\r\n      <div class=\"score-input\">\r\n        <el-form :model=\"recordForm\" :rules=\"rules\" ref=\"recordForm\" label-width=\"100px\">\r\n          <el-form-item label=\"测试成绩\" prop=\"score\">\r\n            <el-input-number \r\n              v-model=\"recordForm.score\" \r\n              :precision=\"2\"\r\n              :step=\"0.1\"\r\n              :min=\"0\"\r\n            ></el-input-number>\r\n            <span class=\"unit\">{{ sportsItem.unit }}</span>\r\n          </el-form-item>\r\n          <el-form-item label=\"备注说明\" prop=\"remark\">\r\n            <el-input \r\n              type=\"textarea\" \r\n              v-model=\"recordForm.remark\"\r\n              placeholder=\"请输入备注说明（选填）\"\r\n              :rows=\"3\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button type=\"primary\" @click=\"submitRecord\">提交成绩</el-button>\r\n            <el-button @click=\"goBack\">返回</el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n\r\n      <!-- 历史记录 -->\r\n      <div class=\"history-records\">\r\n        <div class=\"section-title\">历史记录</div>\r\n        <el-table :data=\"historyRecords\" stripe>\r\n          <el-table-column prop=\"score\" label=\"成绩\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.score }}{{ sportsItem.unit }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"status\" label=\"状态\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              <el-tag :type=\"getStatusType(scope.row.status)\">\r\n                {{ getStatusText(scope.row.status) }}\r\n              </el-tag>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column prop=\"remark\" label=\"备注\"></el-table-column>\r\n          <el-table-column prop=\"createdAt\" label=\"测试时间\" width=\"180\">\r\n            <template slot-scope=\"scope\">\r\n              {{ formatDateTime(scope.row.createdAt) }}\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { formatDateTime } from '@/utils/datetime'\r\n\r\nexport default {\r\n  name: 'TestRecord',\r\n\r\n  data() {\r\n    return {\r\n      sportsItem: {},\r\n      recordForm: {\r\n        score: null,\r\n        remark: ''\r\n      },\r\n      rules: {\r\n        score: [\r\n          { required: true, message: '请输入测试成绩', trigger: 'blur' },\r\n          { type: 'number', message: '成绩必须为数字', trigger: 'blur' }\r\n        ]\r\n      },\r\n      historyRecords: []\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.fetchSportsItem()\r\n    this.fetchHistoryRecords()\r\n  },\r\n\r\n  methods: {\r\n    formatDateTime,\r\n\r\n    async fetchSportsItem() {\r\n      try {\r\n        const id = this.$route.params.id\r\n        const response = await this.$http.get(`/api/student/test-items/${id}`)\r\n        if (response.data.code === 200) {\r\n          this.sportsItem = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取项目信息失败:', error)\r\n        this.$message.error('获取项目信息失败')\r\n      }\r\n    },\r\n\r\n    async fetchHistoryRecords() {\r\n      try {\r\n        const id = this.$route.params.id\r\n        const response = await this.$http.get(`/api/student/test-records/history/${id}`)\r\n        if (response.data.code === 200) {\r\n          this.historyRecords = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取历史记录失败:', error)\r\n        this.$message.error('获取历史记录失败')\r\n      }\r\n    },\r\n\r\n    getStatusType(status) {\r\n      if (status === 'PASSED') return 'success'\r\n      if (status === 'FAILED') return 'danger'\r\n      return 'info'\r\n    },\r\n\r\n    getStatusText(status) {\r\n      if (status === 'PASSED') return '通过'\r\n      if (status === 'FAILED') return '未通过'\r\n      return '待审核'\r\n    },\r\n\r\n    async submitRecord() {\r\n      try {\r\n        await this.$refs.recordForm.validate()\r\n        \r\n        const response = await this.$http.post('/api/student/test-records', {\r\n          sportsItemId: this.sportsItem.id,\r\n          score: this.recordForm.score,\r\n          remark: this.recordForm.remark\r\n        })\r\n\r\n        if (response.data.code === 200) {\r\n          this.$message.success('提交成功')\r\n          this.fetchHistoryRecords()\r\n          this.recordForm.score = null\r\n          this.recordForm.remark = ''\r\n        }\r\n      } catch (error) {\r\n        console.error('提交成绩失败:', error)\r\n        this.$message.error('提交失败：' + (error.response?.data?.message || '未知错误'))\r\n      }\r\n    },\r\n\r\n    goBack() {\r\n      this.$router.push('/student/test-items')\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.test-record {\r\n  padding: 20px;\r\n}\r\n\r\n.score-input {\r\n  margin: 20px 0;\r\n  max-width: 500px;\r\n}\r\n\r\n.unit {\r\n  margin-left: 10px;\r\n  color: #666;\r\n}\r\n\r\n.section-title {\r\n  font-size: 16px;\r\n  font-weight: bold;\r\n  margin: 20px 0;\r\n  padding-left: 10px;\r\n  border-left: 4px solid #409EFF;\r\n}\r\n\r\n.history-records {\r\n  margin-top: 30px;\r\n}\r\n</style> "],"mappings":";AA+EA,SAAAA,cAAA;AAEA;EACAC,IAAA;EAEAC,KAAA;IACA;MACAC,UAAA;MACAC,UAAA;QACAC,KAAA;QACAC,MAAA;MACA;MACAC,KAAA;QACAF,KAAA,GACA;UAAAG,QAAA;UAAAC,OAAA;UAAAC,OAAA;QAAA,GACA;UAAAC,IAAA;UAAAF,OAAA;UAAAC,OAAA;QAAA;MAEA;MACAE,cAAA;IACA;EACA;EAEAC,QAAA;IACA,KAAAC,eAAA;IACA,KAAAC,mBAAA;EACA;EAEAC,OAAA;IACAhB,cAAA;IAEA,MAAAc,gBAAA;MACA;QACA,MAAAG,EAAA,QAAAC,MAAA,CAAAC,MAAA,CAAAF,EAAA;QACA,MAAAG,QAAA,cAAAC,KAAA,CAAAC,GAAA,4BAAAL,EAAA;QACA,IAAAG,QAAA,CAAAlB,IAAA,CAAAqB,IAAA;UACA,KAAApB,UAAA,GAAAiB,QAAA,CAAAlB,IAAA,CAAAA,IAAA;QACA;MACA,SAAAsB,KAAA;QACAC,OAAA,CAAAD,KAAA,cAAAA,KAAA;QACA,KAAAE,QAAA,CAAAF,KAAA;MACA;IACA;IAEA,MAAAT,oBAAA;MACA;QACA,MAAAE,EAAA,QAAAC,MAAA,CAAAC,MAAA,CAAAF,EAAA;QACA,MAAAG,QAAA,cAAAC,KAAA,CAAAC,GAAA,sCAAAL,EAAA;QACA,IAAAG,QAAA,CAAAlB,IAAA,CAAAqB,IAAA;UACA,KAAAX,cAAA,GAAAQ,QAAA,CAAAlB,IAAA,CAAAA,IAAA;QACA;MACA,SAAAsB,KAAA;QACAC,OAAA,CAAAD,KAAA,cAAAA,KAAA;QACA,KAAAE,QAAA,CAAAF,KAAA;MACA;IACA;IAEAG,cAAAC,MAAA;MACA,IAAAA,MAAA;MACA,IAAAA,MAAA;MACA;IACA;IAEAC,cAAAD,MAAA;MACA,IAAAA,MAAA;MACA,IAAAA,MAAA;MACA;IACA;IAEA,MAAAE,aAAA;MACA;QACA,WAAAC,KAAA,CAAA3B,UAAA,CAAA4B,QAAA;QAEA,MAAAZ,QAAA,cAAAC,KAAA,CAAAY,IAAA;UACAC,YAAA,OAAA/B,UAAA,CAAAc,EAAA;UACAZ,KAAA,OAAAD,UAAA,CAAAC,KAAA;UACAC,MAAA,OAAAF,UAAA,CAAAE;QACA;QAEA,IAAAc,QAAA,CAAAlB,IAAA,CAAAqB,IAAA;UACA,KAAAG,QAAA,CAAAS,OAAA;UACA,KAAApB,mBAAA;UACA,KAAAX,UAAA,CAAAC,KAAA;UACA,KAAAD,UAAA,CAAAE,MAAA;QACA;MACA,SAAAkB,KAAA;QAAA,IAAAY,eAAA;QACAX,OAAA,CAAAD,KAAA,YAAAA,KAAA;QACA,KAAAE,QAAA,CAAAF,KAAA,cAAAY,eAAA,GAAAZ,KAAA,CAAAJ,QAAA,cAAAgB,eAAA,gBAAAA,eAAA,GAAAA,eAAA,CAAAlC,IAAA,cAAAkC,eAAA,uBAAAA,eAAA,CAAA3B,OAAA;MACA;IACA;IAEA4B,OAAA;MACA,KAAAC,OAAA,CAAAC,IAAA;IACA;EACA;AACA","ignoreList":[]}]}