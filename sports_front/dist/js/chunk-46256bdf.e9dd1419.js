(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-46256bdf"],{1209:function(e,t,a){},2838:function(e,t,a){"use strict";a("1209")},"38bf":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"appeal-review"},[t("div",{staticClass:"search-bar"},[t("el-form",{attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"处理状态"}},[t("el-select",{attrs:{placeholder:"选择状态",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[t("el-option",{attrs:{label:"待处理",value:"PENDING"}}),t("el-option",{attrs:{label:"已通过",value:"APPROVED"}}),t("el-option",{attrs:{label:"已驳回",value:"REJECTED"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.searchAppeals}},[e._v("查询")])],1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.appealList,border:""}},[t("el-table-column",{attrs:{prop:"studentName",label:"学生姓名",width:"120"}}),t("el-table-column",{attrs:{prop:"studentNumber",label:"学号",width:"120"}}),t("el-table-column",{attrs:{prop:"className",label:"班级",width:"120"}}),t("el-table-column",{attrs:{prop:"testItem",label:"测试项目",width:"120"}}),t("el-table-column",{attrs:{label:"成绩信息",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",[e._v("原始成绩: "+e._s(a.row.originalScore))]),t("div",[e._v("期望成绩: "+e._s(a.row.expectedScore))])]}}])}),t("el-table-column",{attrs:{prop:"reason",label:"申诉理由","min-width":"200"}}),t("el-table-column",{attrs:{prop:"createTime",label:"申请时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDateTime(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusTag(a.row.status)}},[e._v(" "+e._s(e.getStatusLabel(a.row.status))+" ")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"small",disabled:"PENDING"!==a.row.status},on:{click:function(t){return e.handleReview(a.row)}}},[e._v(" 审核 ")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:"申诉审核",visible:e.reviewDialogVisible,width:"50%"},on:{"update:visible":function(t){e.reviewDialogVisible=t}}},[t("el-form",{attrs:{model:e.reviewForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"学生姓名"}},[t("span",[e._v(e._s(e.currentAppeal?e.currentAppeal.studentName:""))])]),t("el-form-item",{attrs:{label:"测试项目"}},[t("span",[e._v(e._s(e.currentAppeal?e.currentAppeal.testItem:""))])]),t("el-form-item",{attrs:{label:"原始成绩"}},[t("span",[e._v(e._s(e.currentAppeal?e.currentAppeal.originalScore:""))])]),t("el-form-item",{attrs:{label:"期望成绩"}},[t("span",[e._v(e._s(e.currentAppeal?e.currentAppeal.expectedScore:""))])]),t("el-form-item",{attrs:{label:"申诉理由"}},[t("div",{staticClass:"appeal-reason"},[e._v(e._s(e.currentAppeal?e.currentAppeal.reason:""))])]),t("el-form-item",{attrs:{label:"审核结果"}},[t("el-radio-group",{model:{value:e.reviewForm.status,callback:function(t){e.$set(e.reviewForm,"status",t)},expression:"reviewForm.status"}},[t("el-radio",{attrs:{label:"APPROVED"}},[e._v("通过")]),t("el-radio",{attrs:{label:"REJECTED"}},[e._v("驳回")])],1)],1),t("el-form-item",{attrs:{label:"审核意见"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入审核意见"},model:{value:e.reviewForm.reviewComment,callback:function(t){e.$set(e.reviewForm,"reviewComment",t)},expression:"reviewForm.reviewComment"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.reviewDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitReview}},[e._v("确定")])],1)],1)],1)},s=[],l={name:"ScoreAppealReview",data(){return{appealList:[],total:0,currentPage:1,pageSize:10,searchForm:{status:""},reviewDialogVisible:!1,currentAppeal:null,reviewForm:{status:"",reviewComment:""}}},created(){this.getAppeals()},methods:{async getAppeals(){try{console.log("正在获取申诉列表，参数:",{status:this.searchForm.status,page:this.currentPage-1,size:this.pageSize});const e=await this.$axios.get("/api/teacher/score-appeals",{params:{status:this.searchForm.status||null,page:this.currentPage-1,size:this.pageSize}});if(console.log("API响应数据:",e.data),200===e.data.code){const{content:t,totalElements:a}=e.data.data;this.appealList=t||[],this.total=a||0,console.log("处理后的申诉列表:",this.appealList)}else this.$message.error(e.data.message||"获取数据失败")}catch(t){var e;console.error("获取申诉列表失败:",t),this.$message.error("获取申诉列表失败: "+((null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)||t.message))}},searchAppeals(){this.currentPage=1,this.getAppeals()},handleReview(e){this.currentAppeal=e,this.reviewForm={status:"",reviewComment:""},this.reviewDialogVisible=!0},async submitReview(){if(this.reviewForm.status)try{const e=await this.$axios.put(`/api/teacher/score-appeals/${this.currentAppeal.id}/review`,{status:this.reviewForm.status,reviewComment:this.reviewForm.reviewComment,expectedScore:this.currentAppeal.expectedScore});200===e.data.code?(this.$message.success("审核成功"),this.reviewDialogVisible=!1,this.getAppeals()):this.$message.error(e.data.message||"审核失败")}catch(e){console.error("审核失败:",e),this.$message.error("审核失败")}else this.$message.warning("请选择审核结果")},handlePageChange(e){this.currentPage=e,this.getAppeals()},formatDateTime(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`},getStatusTag(e){const t={PENDING:"warning",APPROVED:"success",REJECTED:"danger"};return t[e]||""},getStatusLabel(e){const t={PENDING:"待处理",APPROVED:"已通过",REJECTED:"已驳回"};return t[e]||e}}},i=l,o=(a("2838"),a("2877")),n=Object(o["a"])(i,r,s,!1,null,"5c83f780",null);t["default"]=n.exports}}]);
//# sourceMappingURL=chunk-46256bdf.e9dd1419.js.map