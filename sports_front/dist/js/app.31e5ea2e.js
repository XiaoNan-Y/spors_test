(function(e){function t(t){for(var s,r,l=t[0],n=t[1],c=t[2],d=0,u=[];d<l.length;d++)r=l[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s]);m&&m(t);while(u.length)u.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,r=1;r<a.length;r++){var l=a[r];0!==i[l]&&(s=!1)}s&&(o.splice(t--,1),e=n(n.s=a[0]))}return e}var s={},r={app:0},i={app:0},o=[];function l(e){return n.p+"js/"+({}[e]||e)+"."+{"chunk-014840ba":"e4c870b7","chunk-0c9c9b67":"c1799e1e","chunk-13199d7f":"4f24b5fe","chunk-2904a65b":"dbf78eaf","chunk-3c786940":"75baa641","chunk-5008bcf5":"7f89b51e","chunk-58dfa14e":"b9a5ee9a","chunk-58f0b7c2":"7344eff6","chunk-61645b83":"adfb4cc6","chunk-e036a840":"1ea4ab21"}[e]+".js"}function n(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.e=function(e){var t=[],a={"chunk-014840ba":1,"chunk-0c9c9b67":1,"chunk-13199d7f":1,"chunk-2904a65b":1,"chunk-3c786940":1,"chunk-5008bcf5":1,"chunk-58dfa14e":1,"chunk-58f0b7c2":1,"chunk-61645b83":1,"chunk-e036a840":1};r[e]?t.push(r[e]):0!==r[e]&&a[e]&&t.push(r[e]=new Promise((function(t,a){for(var s="css/"+({}[e]||e)+"."+{"chunk-014840ba":"c247f2e2","chunk-0c9c9b67":"c81aafc4","chunk-13199d7f":"e4e2cf67","chunk-2904a65b":"24a88da1","chunk-3c786940":"2c254c25","chunk-5008bcf5":"a485c083","chunk-58dfa14e":"743342b6","chunk-58f0b7c2":"23b700e9","chunk-61645b83":"092ed0a3","chunk-e036a840":"4b704e38"}[e]+".css",i=n.p+s,o=document.getElementsByTagName("link"),l=0;l<o.length;l++){var c=o[l],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===s||d===i))return t()}var u=document.getElementsByTagName("style");for(l=0;l<u.length;l++){c=u[l],d=c.getAttribute("data-href");if(d===s||d===i)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var s=t&&t.target&&t.target.src||i,o=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=s,delete r[e],m.parentNode.removeChild(m),a(o)},m.href=i;var p=document.getElementsByTagName("head")[0];p.appendChild(m)})).then((function(){r[e]=0})));var s=i[e];if(0!==s)if(s)t.push(s[2]);else{var o=new Promise((function(t,a){s=i[e]=[t,a]}));t.push(s[2]=o);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,n.nc&&d.setAttribute("nonce",n.nc),d.src=l(e);var u=new Error;c=function(t){d.onerror=d.onload=null,clearTimeout(m);var a=i[e];if(0!==a){if(a){var s=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",u.name="ChunkLoadError",u.type=s,u.request=r,a[1](u)}i[e]=void 0}};var m=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(t)},n.m=e,n.c=s,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(a,s,function(t){return e[t]}.bind(null,s));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var m=d;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0d4f":function(e,t,a){},"311f":function(e,t,a){"use strict";a("e203")},"341e":function(e,t,a){},"356c":function(e,t,a){},"382e":function(e,t,a){"use strict";a("b1ef")},"3bd8":function(e,t,a){},"45af":function(e,t,a){},4666:function(e,t,a){"use strict";a("45af")},"4f06":function(e,t,a){"use strict";a("c69b")},"56d7":function(e,t,a){"use strict";a.r(t);var s=a("2b0e"),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},i=[],o={name:"App"},l=o,n=(a("749e"),a("2877")),c=Object(n["a"])(l,r,i,!1,null,null,null),d=c.exports,u=a("8c4f"),m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,rules:e.loginRules}},[t("h3",{staticClass:"title"},[e._v("体育测试管理系统")]),t("el-form-item",{attrs:{prop:"username"}},[t("el-input",{attrs:{placeholder:"用户名",type:"text","auto-complete":"off"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),t("el-form-item",{attrs:{prop:"password"}},[t("el-input",{attrs:{placeholder:"密码",type:"password","auto-complete":"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-button",{staticStyle:{width:"100%"},attrs:{loading:e.loading,type:"primary"},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e._v(" 登录 ")])],1)],1)},p=[],h=(a("14d9"),{name:"Login",data(){return{loginForm:{username:"",password:""},loginRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loading:!1}},methods:{async handleLogin(){try{const e=await this.$axios.post("/api/users/login",this.loginForm);if(200===e.data.code){const t=e.data.data;switch(localStorage.setItem("token",t.token),localStorage.setItem("username",t.username),localStorage.setItem("userRole",t.userType),localStorage.setItem("userId",t.id),t.userType){case"STUDENT":this.$router.push("/student/test-records");break;case"TEACHER":this.$router.push("/teacher/dashboard");break;case"ADMIN":this.$router.push("/admin/dashboard");break;default:this.$router.push("/login")}this.$message.success("登录成功")}else this.$message.error(e.data.message||"登录失败")}catch(e){console.error("登录失败:",e),this.$message.error("登录失败")}}}}),f=h,g=(a("cb98"),Object(n["a"])(f,m,p,!1,null,"2b783991",null)),b=g.exports,v=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"admin-layout"},[t("el-aside",{attrs:{width:"200px"}},[t("el-menu",{staticClass:"el-menu-vertical",attrs:{"default-active":e.activeMenu,"background-color":"#304156","text-color":"#bfcbd9","active-text-color":"#409EFF",router:!0}},[t("el-menu-item",{attrs:{index:"/admin/dashboard"}},[t("i",{staticClass:"el-icon-s-home"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),t("el-submenu",{attrs:{index:"1"}},[t("template",{slot:"title"},[t("i",{staticClass:"el-icon-user"}),t("span",[e._v("用户管理")])]),t("el-menu-item",{attrs:{index:"/admin/users/student"}},[e._v("学生管理")]),t("el-menu-item",{attrs:{index:"/admin/users/teacher"}},[e._v("教师管理")])],2),t("el-menu-item",{attrs:{index:"/admin/sports-items"}},[t("i",{staticClass:"el-icon-trophy"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("体测项目管理")])]),t("el-menu-item",{attrs:{index:"/admin/notices"}},[t("i",{staticClass:"el-icon-bell"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("通知管理")])]),t("el-menu-item",{attrs:{index:"/admin/data-review"}},[t("i",{staticClass:"el-icon-document-checked"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("数据录入与审核")])]),t("el-menu-item",{attrs:{index:"/admin/exemption-review"}},[t("i",{staticClass:"el-icon-document"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("免测/重测申请")])]),t("el-menu-item",{attrs:{index:"/admin/profile"}},[t("i",{staticClass:"el-icon-user"}),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("个人信息")])])],1)],1),t("el-container",[t("el-header",[t("div",{staticClass:"header-left"},[e._v("体育测试管理系统-管理员端")]),t("div",{staticClass:"header-right"},[t("el-dropdown",{on:{command:e.handleCommand}},[t("span",{staticClass:"el-dropdown-link"},[e._v(" "+e._s(e.username)),t("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{command:"profile"}},[e._v("个人信息")]),t("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出登录")])],1)],1)],1)]),t("el-main",[t("router-view")],1)],1)],1)},y=[],w={name:"AdminLayout",data(){return{username:"",activeMenu:""}},created(){const e=JSON.parse(localStorage.getItem("user"));this.username=e?e.username:"",this.activeMenu=this.$route.path},methods:{handleCommand(e){"logout"===e&&(localStorage.removeItem("user"),this.$router.push("/login"))}}},_=w,k=(a("4666"),Object(n["a"])(_,v,y,!1,null,"3d825278",null)),S=k.exports,C=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"filter-section"},[t("el-form",{attrs:{inline:!0,model:e.filterForm}},[t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{attrs:{placeholder:"选择状态"},model:{value:e.filterForm.status,callback:function(t){e.$set(e.filterForm,"status",t)},expression:"filterForm.status"}},[t("el-option",{attrs:{label:"全部",value:""}}),t("el-option",{attrs:{label:"待审核",value:"PENDING"}}),t("el-option",{attrs:{label:"已通过",value:"APPROVED"}}),t("el-option",{attrs:{label:"已驳回",value:"REJECTED"}})],1)],1),t("el-form-item",{attrs:{label:"体测项目"}},[t("el-select",{attrs:{placeholder:"选择项目"},model:{value:e.filterForm.sportsItemId,callback:function(t){e.$set(e.filterForm,"sportsItemId",t)},expression:"filterForm.sportsItemId"}},[t("el-option",{attrs:{label:"全部",value:""}}),e._l(e.sportsItems,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.fetchRecords}},[e._v("查询")]),t("el-button",{attrs:{type:"success"},on:{click:e.handleExport}},[e._v("导出")])],1)],1)],1),t("el-table",{attrs:{data:e.records,border:""}},[t("el-table-column",{attrs:{prop:"student.realName",label:"学生姓名"}}),t("el-table-column",{attrs:{prop:"student.studentNumber",label:"学号"}}),t("el-table-column",{attrs:{prop:"sportsItem.name",label:"测试项目"}}),t("el-table-column",{attrs:{prop:"score",label:"成绩"}}),t("el-table-column",{attrs:{prop:"testTime",label:"测试时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDateTime(t.row.testTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getStatusText(t.row.status))+" ")]}}])}),t("el-table-column",{attrs:{prop:"reviewComment",label:"审核意见"}}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return["PENDING"===a.row.status?t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleReview(a.row)}}},[e._v(" 审核 ")]):e._e(),"PENDING"!==a.row.status?t("el-button",{attrs:{size:"mini",type:"warning"},on:{click:function(t){return e.handleModify(a.row)}}},[e._v(" 修改 ")]):e._e()]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}}),t("test-record-review",{attrs:{visible:e.reviewDialogVisible,record:e.currentRecord},on:{"update:visible":function(t){e.reviewDialogVisible=t},success:e.handleReviewSuccess}}),t("el-dialog",{attrs:{title:"修改审核结果",visible:e.modifyDialogVisible,width:"500px"},on:{"update:visible":function(t){e.modifyDialogVisible=t}}},[t("el-form",{ref:"modifyForm",attrs:{model:e.modifyForm,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"审核状态",prop:"status"}},[t("el-radio-group",{model:{value:e.modifyForm.status,callback:function(t){e.$set(e.modifyForm,"status",t)},expression:"modifyForm.status"}},[t("el-radio",{attrs:{label:"APPROVED"}},[e._v("通过")]),t("el-radio",{attrs:{label:"REJECTED"}},[e._v("驳回")])],1)],1),t("el-form-item",{attrs:{label:"审核意见",prop:"comment"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入审核意见"},model:{value:e.modifyForm.comment,callback:function(t){e.$set(e.modifyForm,"comment",t)},expression:"modifyForm.comment"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.modifyDialogVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitModify}},[e._v("确 定")])],1)],1)],1)},E=[];a("88a7"),a("271a"),a("5494");function $(e){if(!e)return"";const t=new Date(e),a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),l=String(t.getSeconds()).padStart(2,"0");return`${a}-${s}-${r} ${i}:${o}:${l}`}var T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"test-record-review"},[t("el-dialog",{attrs:{title:"测试记录审核",visible:e.visible,width:"500px"},on:{"update:visible":function(t){e.visible=t},close:e.handleClose}},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"学生姓名"}},[t("span",[e._v(e._s(e.record.student?e.record.student.realName:""))])]),t("el-form-item",{attrs:{label:"学号"}},[t("span",[e._v(e._s(e.record.studentNumber))])]),t("el-form-item",{attrs:{label:"测试项目"}},[t("span",[e._v(e._s(e.record.sportsItem?e.record.sportsItem.name:""))])]),t("el-form-item",{attrs:{label:"测试成绩"}},[t("span",[e._v(e._s(e.record.score))])]),t("el-form-item",{attrs:{label:"测试时间"}},[t("span",[e._v(e._s(e.formatDateTime(e.record.testTime)))])]),t("el-form-item",{attrs:{label:"审核状态",prop:"status"}},[t("el-radio-group",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},[t("el-radio",{attrs:{label:"APPROVED"}},[e._v("通过")]),t("el-radio",{attrs:{label:"REJECTED"}},[e._v("驳回")])],1)],1),t("el-form-item",{attrs:{label:"审核意见",prop:"comment"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入审核意见"},model:{value:e.form.comment,callback:function(t){e.$set(e.form,"comment",t)},expression:"form.comment"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.handleClose}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确 定")])],1)],1)],1)},x=[],I={name:"TestRecordReview",props:{visible:{type:Boolean,default:!1},record:{type:Object,default:()=>({})}},data(){return{form:{status:"",comment:""}}},methods:{formatDateTime:$,handleClose(){this.$emit("update:visible",!1),this.resetForm()},resetForm(){this.form={status:"",comment:""}},async handleSubmit(){try{const e=await this.$axios.put("/api/admin/test-record/review",{id:this.record.id,status:this.form.status,comment:this.form.comment,reviewerId:this.$store.state.user.id});200===e.data.code?(this.$message.success("审核成功"),this.$emit("success"),this.handleClose()):this.$message.error(e.data.msg||"审核失败")}catch(e){this.$message.error("审核失败："+e.message)}}},watch:{record:{handler(e){e&&(this.form.status="",this.form.comment="")},immediate:!0}}},R=I,D=(a("7e79"),Object(n["a"])(R,T,x,!1,null,"c1bee01e",null)),N=D.exports,P={components:{TestRecordReview:N},data(){return{records:[],sportsItems:[],filterForm:{status:"",sportsItemId:""},currentPage:1,pageSize:10,total:0,reviewDialogVisible:!1,modifyDialogVisible:!1,currentRecord:null,modifyForm:{status:"",comment:""}}},methods:{formatDateTime:$,getStatusText(e){const t={PENDING:"待审核",APPROVED:"已通过",REJECTED:"已驳回"};return t[e]||e},async fetchRecords(){try{const e=await this.$axios.get("/api/admin/test-record/review",{params:{status:this.filterForm.status,sportsItemId:this.filterForm.sportsItemId,pageNum:this.currentPage,pageSize:this.pageSize}});200===e.data.code&&(this.records=e.data.data.content,this.total=e.data.data.totalElements)}catch(e){this.$message.error("获取记录失败："+e.message)}},async fetchSportsItems(){try{const e=await this.$axios.get("/api/admin/sports-items");200===e.data.code&&(this.sportsItems=e.data.data)}catch(e){this.$message.error("获取体测项目失败："+e.message)}},handlePageChange(e){this.currentPage=e,this.fetchRecords()},handleReview(e){this.currentRecord=e,this.reviewDialogVisible=!0},handleReviewSuccess(){this.fetchRecords()},handleModify(e){this.currentRecord=e,this.modifyForm.status=e.status,this.modifyForm.comment=e.reviewComment,this.modifyDialogVisible=!0},async submitModify(){try{const e=await this.$axios.put("/api/admin/test-record/modify",{id:this.currentRecord.id,status:this.modifyForm.status,comment:this.modifyForm.comment,reviewerId:this.$store.state.user.id});200===e.data.code?(this.$message.success("修改成功"),this.modifyDialogVisible=!1,this.fetchRecords()):this.$message.error(e.data.msg||"修改失败")}catch(e){this.$message.error("修改失败："+e.message)}},async handleExport(){try{const e=await this.$axios.get("/api/admin/test-record/export",{params:{status:this.filterForm.status,sportsItemId:this.filterForm.sportsItemId},responseType:"blob"}),t=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","test_records.xlsx"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}catch(e){this.$message.error("导出失败："+e.message)}}},created(){this.fetchSportsItems(),this.fetchRecords()}},F=P,A=(a("382e"),Object(n["a"])(F,C,E,!1,null,"38689621",null)),z=A.exports,O=function(){var e=this,t=e._self._c;return t("div",[t("el-table",{attrs:{data:e.users,border:""}},[t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"realName",label:"姓名"}}),"STUDENT"===e.userType?t("el-table-column",{attrs:{prop:"studentNumber",label:"学号"}}):e._e(),t("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),t("el-table-column",{attrs:{prop:"phone",label:"电话"}}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)},L=[],V={data(){return{users:[],userType:"",currentPage:1,pageSize:10,total:0}},methods:{async fetchUsers(){try{const e="STUDENT"===this.userType?"/students":"/teachers",t=await this.$axios.get("/api/admin/users"+e,{params:{pageNum:this.currentPage,pageSize:this.pageSize}});200===t.data.code?(this.users=t.data.data.content,this.total=t.data.data.totalElements):this.$message.error(t.data.msg||"获取用户列表失败")}catch(e){this.$message.error("获取用户列表失败："+e.message)}},handlePageChange(e){this.currentPage=e,this.fetchUsers()},handleEdit(e){this.$emit("edit",e)},handleDelete(e){this.$confirm("确认删除该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=await this.$axios.delete("/api/admin/users/"+e.id);200===t.data.code?(this.$message.success("删除成功"),this.fetchUsers()):this.$message.error(t.data.msg||"删除失败")}catch(t){this.$message.error("删除失败："+t.message)}}).catch(()=>{})}},created(){this.fetchUsers()},watch:{userType:{handler(e){e&&(this.currentPage=1,this.fetchUsers())},immediate:!0}}},U=V,M=Object(n["a"])(U,O,L,!1,null,null,null),j=M.exports,q=function(){var e=this,t=e._self._c;return t("div",{staticClass:"dashboard"},[t("el-row",{staticClass:"stats-row",attrs:{gutter:20}},[t("el-col",{attrs:{span:6}},[t("el-card",{staticClass:"stats-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-icon student-icon"},[t("i",{staticClass:"el-icon-user"})]),t("div",{staticClass:"stats-info"},[t("div",{staticClass:"stats-title"},[e._v("学生总数")]),t("div",{staticClass:"stats-number"},[e._v(e._s(e.stats.studentCount))]),t("div",{staticClass:"stats-desc"},[e._v("在校学生总人数")])])])],1),t("el-col",{attrs:{span:6}},[t("el-card",{staticClass:"stats-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-icon teacher-icon"},[t("i",{staticClass:"el-icon-s-custom"})]),t("div",{staticClass:"stats-info"},[t("div",{staticClass:"stats-title"},[e._v("教师总数")]),t("div",{staticClass:"stats-number"},[e._v(e._s(e.stats.teacherCount))]),t("div",{staticClass:"stats-desc"},[e._v("任职教师总人数")])])])],1),t("el-col",{attrs:{span:6}},[t("el-card",{staticClass:"stats-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-icon item-icon"},[t("i",{staticClass:"el-icon-trophy"})]),t("div",{staticClass:"stats-info"},[t("div",{staticClass:"stats-title"},[e._v("体育项目")]),t("div",{staticClass:"stats-number"},[t("count-to",{attrs:{"start-val":0,"end-val":e.stats.sportsItemCount,duration:2e3}})],1),t("div",{staticClass:"stats-desc"},[e._v("当前测试项目数")])])])],1),t("el-col",{attrs:{span:6}},[t("el-card",{staticClass:"stats-card",attrs:{shadow:"hover"}},[t("div",{staticClass:"stats-icon record-icon"},[t("i",{staticClass:"el-icon-data-line"})]),t("div",{staticClass:"stats-info"},[t("div",{staticClass:"stats-title"},[e._v("测试记录")]),t("div",{staticClass:"stats-number"},[t("count-to",{attrs:{"start-val":0,"end-val":e.stats.testRecordCount,duration:2e3}})],1),t("div",{staticClass:"stats-desc"},[e._v("累计测试记录数")])])])],1)],1),t("el-row",{staticClass:"quick-access",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("快捷操作")])]),t("div",{staticClass:"quick-buttons"},[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.$router.push("/admin/users/student")}}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 添加学生 ")]),t("el-button",{attrs:{type:"success"},on:{click:function(t){return e.$router.push("/admin/users/teacher")}}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 添加教师 ")]),t("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.$router.push("/admin/sports-items")}}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 添加项目 ")]),t("el-button",{attrs:{type:"info"},on:{click:function(t){return e.$router.push("/admin/notices")}}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 发布公告 ")])],1)])],1),t("el-col",{attrs:{span:12}},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("最新公告")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(t){return e.$router.push("/admin/notices")}}},[e._v(" 查看更多 ")])],1),e.notices.length>0?t("div",e._l(e.notices,(function(a){return t("div",{key:a.id,staticClass:"notice-item"},[t("span",{staticClass:"notice-title"},[e._v(e._s(a.title))]),t("span",{staticClass:"notice-time"},[e._v(e._s(a.createTime))])])})),0):t("div",{staticClass:"empty-text"},[e._v(" 暂无公告 ")])])],1)],1),t("el-row",{staticClass:"charts-row",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("各年级学生分布")])]),t("div",{staticClass:"chart-container"})])],1),t("el-col",{attrs:{span:12}},[t("el-card",{staticClass:"box-card"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v("测试成绩分布")])]),t("div",{staticClass:"chart-container"})])],1)],1)],1)},H=[],J=a("ec1b"),G=a.n(J),B={name:"Dashboard",components:{CountTo:G.a},data(){return{stats:{studentCount:0,teacherCount:0,sportsItemCount:0,testRecordCount:0},notices:[],loading:{stats:!1,notices:!1}}},async created(){await this.fetchStats(),await this.fetchNotices()},methods:{async fetchStats(){try{this.loading.stats=!0;const e=await this.$http.get("/api/admin/dashboard/stats");200===e.data.code?this.stats=e.data.data:this.$message.error(e.data.msg||"获取统计数据失败")}catch(e){console.error("获取统计数据失败:",e),this.$message.error("获取统计数据失败: "+e.message)}finally{this.loading.stats=!1}},async fetchNotices(){try{const e=await this.$http.get("/api/admin/notices/latest");200===e.data.code?this.notices=e.data.data||[]:(console.warn("获取公告失败:",e.data.msg),this.notices=[])}catch(e){console.error("获取公告失败:",e),this.notices=[]}},formatDate(e){return e?new Date(e).toLocaleString():""}}},K=B,Y=(a("5a41"),Object(n["a"])(K,q,H,!1,null,"52743e92",null)),Q=Y.exports,W=function(){var e=this,t=e._self._c;return t("div",{staticClass:"student-management"},[t("div",{staticClass:"filter-section"},[t("el-form",{attrs:{inline:!0,model:e.filterForm}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"搜索姓名/学号",clearable:""},on:{clear:e.handleSearch},model:{value:e.filterForm.keyword,callback:function(t){e.$set(e.filterForm,"keyword",t)},expression:"filterForm.keyword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),t("el-button",{attrs:{type:"success"},on:{click:e.handleAdd}},[e._v("添加学生")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.students,border:""}},[t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"realName",label:"姓名"}}),t("el-table-column",{attrs:{prop:"studentNumber",label:"学号"}}),t("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),t("el-table-column",{attrs:{prop:"phone",label:"电话"}}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}}),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("user-form",{ref:"userForm",attrs:{"user-type":"STUDENT"},on:{saved:e.handleSaved}})],1)],1)},X=[],Z=a("82e5"),ee={name:"StudentManagement",components:{UserForm:Z["a"]},data(){return{students:[],loading:!1,currentPage:1,pageSize:10,total:0,filterForm:{keyword:""},dialogVisible:!1,dialogTitle:"添加学生",currentUser:null}},methods:{async fetchStudents(){try{this.loading=!0,console.log("Fetching students...");const e=await this.$axios.get("/api/users/students",{params:{pageNum:this.currentPage,pageSize:this.pageSize,keyword:this.filterForm.keyword}});console.log("Response:",e),200===e.data.code?(this.students=e.data.data.content,this.total=e.data.data.totalElements):this.$message.error(e.data.msg||"获取学生列表失败")}catch(t){var e;console.error("Error details:",t),this.$message.error((null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.msg)||t.message||"获取学生列表失败")}finally{this.loading=!1}},handleSearch(){this.currentPage=1,this.fetchStudents()},handlePageChange(e){this.currentPage=e,this.fetchStudents()},handleAdd(){this.dialogTitle="添加学生",this.currentUser=null,this.dialogVisible=!0},handleEdit(e){this.dialogTitle="编辑学生",this.currentUser=e,this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.userForm.setFormData(e)})},async handleDelete(e){try{await this.$confirm("确认删除该学生?","提示",{type:"warning"});const t=await this.$axios.delete("/api/users/"+e.id);200===t.data.code?(this.$message.success("删除成功"),this.fetchStudents()):this.$message.error(t.data.msg||"删除失败")}catch(t){"cancel"!==t&&this.$message.error("删除失败："+t.message)}},handleSaved(){this.dialogVisible=!1,this.fetchStudents()}},created(){this.fetchStudents()}},te=ee,ae=(a("311f"),Object(n["a"])(te,W,X,!1,null,"39a3fd0e",null)),se=ae.exports,re=function(){var e=this,t=e._self._c;return t("div",{staticClass:"teacher-management"},[t("div",{staticClass:"filter-section"},[t("el-form",{attrs:{inline:!0,model:e.filterForm}},[t("el-form-item",[t("el-input",{attrs:{placeholder:"搜索姓名",clearable:""},on:{clear:e.handleSearch},model:{value:e.filterForm.keyword,callback:function(t){e.$set(e.filterForm,"keyword",t)},expression:"filterForm.keyword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")]),t("el-button",{attrs:{type:"success"},on:{click:e.handleAdd}},[e._v("添加教师")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.teachers,border:""}},[t("el-table-column",{attrs:{prop:"username",label:"用户名"}}),t("el-table-column",{attrs:{prop:"realName",label:"姓名"}}),t("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),t("el-table-column",{attrs:{prop:"phone",label:"电话"}}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.total},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}}),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("user-form",{ref:"userForm",attrs:{"user-type":"TEACHER"},on:{saved:e.handleSaved}})],1)],1)},ie=[],oe={name:"TeacherManagement",components:{UserForm:Z["a"]},data(){return{teachers:[],loading:!1,currentPage:1,pageSize:10,total:0,filterForm:{keyword:""},dialogVisible:!1,dialogTitle:"添加教师",currentUser:null}},methods:{async fetchTeachers(){try{this.loading=!0,console.log("Fetching teachers...");const e=await this.$axios.get("/api/users/teachers",{params:{pageNum:this.currentPage,pageSize:this.pageSize,keyword:this.filterForm.keyword}});console.log("Response:",e),200===e.data.code?(this.teachers=e.data.data.content,this.total=e.data.data.totalElements):this.$message.error(e.data.msg||"获取教师列表失败")}catch(t){var e;console.error("Error details:",t),this.$message.error((null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.msg)||t.message||"获取教师列表失败")}finally{this.loading=!1}},handleSearch(){this.currentPage=1,this.fetchTeachers()},handlePageChange(e){this.currentPage=e,this.fetchTeachers()},handleAdd(){this.dialogTitle="添加教师",this.currentUser=null,this.dialogVisible=!0},handleEdit(e){this.dialogTitle="编辑教师",this.currentUser=e,this.dialogVisible=!0,this.$nextTick(()=>{this.$refs.userForm.setFormData(e)})},async handleDelete(e){try{await this.$confirm("确认删除该教师?","提示",{type:"warning"});const t=await this.$axios.delete("/api/users/"+e.id);200===t.data.code?(this.$message.success("删除成功"),this.fetchTeachers()):this.$message.error(t.data.msg||"删除失败")}catch(t){"cancel"!==t&&this.$message.error("删除失败："+t.message)}},handleSaved(){this.dialogVisible=!1,this.fetchTeachers()}},created(){this.fetchTeachers()}},le=oe,ne=(a("b18b"),Object(n["a"])(le,re,ie,!1,null,"34925c10",null)),ce=ne.exports,de=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sports-item-management"},[t("div",{staticClass:"operation-bar"},[t("div",{staticClass:"search-area"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入项目名称搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1)],1),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 添加项目 ")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData||[],border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t("el-table-column",{attrs:{prop:"name",label:"项目名称"}}),t("el-table-column",{attrs:{prop:"type",label:"项目类型",width:"100"}}),t("el-table-column",{attrs:{prop:"description",label:"项目描述","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"unit",label:"计量单位",width:"100"}}),t("el-table-column",{attrs:{prop:"isActive",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.handleStatusChange(a.row)}},model:{value:a.row.isActive,callback:function(t){e.$set(a.row,"isActive",t)},expression:"scope.row.isActive"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button-group",[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v(" 删除 ")])],1)]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.page.current,"page-sizes":[10,20,50,100],"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"项目名称",prop:"name"}},[t("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("el-form-item",{attrs:{label:"项目类型",prop:"type"}},[t("el-select",{attrs:{placeholder:"请选择项目类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-option",{attrs:{label:"田径",value:"田径"}}),t("el-option",{attrs:{label:"力量",value:"力量"}})],1)],1),t("el-form-item",{attrs:{label:"项目描述",prop:"description"}},[t("el-input",{attrs:{type:"textarea",rows:"3"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),t("el-form-item",{attrs:{label:"计量单位",prop:"unit"}},[t("el-input",{model:{value:e.form.unit,callback:function(t){e.$set(e.form,"unit",t)},expression:"form.unit"}})],1),t("el-form-item",{attrs:{label:"状态",prop:"isActive"}},[t("el-switch",{model:{value:e.form.isActive,callback:function(t){e.$set(e.form,"isActive",t)},expression:"form.isActive"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)],1)},ue=[],me={name:"SportsItemManagement",data(){return{searchKeyword:"",tableData:[],loading:!1,dialogVisible:!1,dialogTitle:"",form:{id:null,name:"",type:"",description:"",unit:"",isActive:!0},page:{current:1,size:10,total:0},rules:{name:[{required:!0,message:"请输入项目名称",trigger:"blur"}],type:[{required:!0,message:"请选择项目类型",trigger:"change"}],unit:[{required:!0,message:"请输入计量单位",trigger:"blur"}]}}},created(){this.initData()},methods:{async initData(){await this.fetchItemList()},async fetchItemList(){try{this.loading=!0;const e=await this.$http.get("/api/admin/sports-items",{params:{keyword:this.searchKeyword,page:this.page.current-1,size:this.page.size}});if(console.log("API Response:",e.data),200===e.data.code&&e.data.data){const t=e.data.data;Array.isArray(t.content)?this.tableData=t.content:(console.error("Invalid data format:",t),this.tableData=[]),this.page.total=t.totalElements||0}else this.$message.error(e.data.message||"获取数据失败"),this.tableData=[]}catch(e){console.error("获取体测项目列表失败:",e),this.$message.error("获取体测项目列表失败"),this.tableData=[]}finally{this.loading=!1}},handleSearch(){this.page.current=1,this.fetchItemList()},handleSizeChange(e){this.page.size=e,this.fetchItemList()},handleCurrentChange(e){this.page.current=e,this.fetchItemList()},handleAdd(){this.dialogTitle="添加体测项目",this.form={id:null,name:"",type:"",description:"",unit:"",isActive:!0},this.dialogVisible=!0},handleEdit(e){this.dialogTitle="编辑体测项目",this.form={...e},this.dialogVisible=!0},async handleSubmit(){this.$refs.form.validate(async e=>{if(e)try{const e=this.form.id?"/api/admin/sports-items/"+this.form.id:"/api/admin/sports-items",t=this.form.id?"put":"post",a=await this.$http[t](e,this.form);200===a.data.code&&(this.$message.success(this.form.id?"更新成功":"添加成功"),this.dialogVisible=!1,this.fetchItemList())}catch(t){this.$message.error("操作失败")}})},async handleDelete(e){try{await this.$confirm("确认删除该体测项目吗？","提示",{type:"warning"});const t=await this.$http.delete("/api/admin/sports-items/"+e.id);200===t.data.code&&(this.$message.success("删除成功"),this.fetchItemList())}catch(t){"cancel"!==t&&this.$message.error("删除失败")}},async handleStatusChange(e){try{const t=await this.$http.put(`/api/admin/sports-items/${e.id}/status`,{isActive:e.isActive});200===t.data.code?this.$message.success((e.isActive?"启用":"禁用")+"成功"):(e.isActive=!e.isActive,this.$message.error("操作失败"))}catch(t){e.isActive=!e.isActive,this.$message.error("操作失败")}}}},pe=me,he=(a("4f06"),Object(n["a"])(pe,de,ue,!1,null,"d2a4333c",null)),fe=he.exports,ge=function(){var e=this,t=e._self._c;return t("div",{staticClass:"notice-management"},[t("div",{staticClass:"operation-bar"},[t("div",{staticClass:"search-area"},[t("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入标题搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchKeyword,callback:function(t){e.searchKeyword=t},expression:"searchKeyword"}},[t("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1),t("el-select",{staticStyle:{width:"120px","margin-left":"10px"},attrs:{placeholder:"通知类型"},model:{value:e.searchType,callback:function(t){e.searchType=t},expression:"searchType"}},[t("el-option",{attrs:{label:"全部",value:""}}),t("el-option",{attrs:{label:"体测安排",value:"TEST_SCHEDULE"}}),t("el-option",{attrs:{label:"成绩公布",value:"SCORE_RELEASE"}}),t("el-option",{attrs:{label:"系统维护",value:"SYSTEM_MAINTENANCE"}}),t("el-option",{attrs:{label:"其他通知",value:"OTHER"}})],1)],1),t("el-button",{attrs:{type:"primary"},on:{click:e.handleAdd}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 发布通知 ")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.noticeList,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t("el-table-column",{attrs:{prop:"type",label:"类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getTypeTagType(a.row.type)}},[e._v(" "+e._s(e.getTypeLabel(a.row.type))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"title",label:"标题","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{class:{"important-notice":"HIGH"===a.row.priority}},[e._v(" "+e._s(a.row.title)+" ")])]}}])}),t("el-table-column",{attrs:{prop:"createTime",label:"发布时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDate(t.row.createTime))+" ")]}}])}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(t){return e.handleStatusChange(a.row)}},model:{value:a.row.status,callback:function(t){e.$set(a.row,"status",t)},expression:"scope.row.status"}})]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button-group",{staticClass:"operation-group"},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.handleView(a.row)}}},[e._v(" 查看 ")]),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v(" 编辑 ")]),t("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v(" 删除 ")])],1)]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.page.current,"page-sizes":[10,20,50,100],"page-size":e.page.size,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible,width:"700px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"通知类型",prop:"type"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择通知类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-option",{attrs:{label:"体测安排",value:"TEST_SCHEDULE"}}),t("el-option",{attrs:{label:"成绩公布",value:"SCORE_RELEASE"}}),t("el-option",{attrs:{label:"系统维护",value:"SYSTEM_MAINTENANCE"}}),t("el-option",{attrs:{label:"其他通知",value:"OTHER"}})],1)],1),t("el-form-item",{attrs:{label:"重要程度",prop:"priority"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择重要程度"},model:{value:e.form.priority,callback:function(t){e.$set(e.form,"priority",t)},expression:"form.priority"}},[t("el-option",{attrs:{label:"普通",value:"NORMAL"}}),t("el-option",{attrs:{label:"重要",value:"HIGH"}})],1)],1),t("el-form-item",{attrs:{label:"标题",prop:"title"}},[t("el-input",{attrs:{maxlength:"100","show-word-limit":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("el-form-item",{attrs:{label:"内容",prop:"content"}},[t("el-input",{attrs:{type:"textarea",rows:10,maxlength:"2000","show-word-limit":""},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),t("el-form-item",{attrs:{label:"状态",prop:"status"}},[t("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"查看通知",visible:e.viewDialogVisible,width:"700px"},on:{"update:visible":function(t){e.viewDialogVisible=t}}},[t("div",{staticClass:"notice-header"},[t("el-tag",{staticClass:"notice-type",attrs:{type:e.getTypeTagType(e.currentNotice.type)}},[e._v(" "+e._s(e.getTypeLabel(e.currentNotice.type))+" ")]),t("h3",{staticClass:"notice-title"},[e._v(e._s(e.currentNotice.title))])],1),t("div",{staticClass:"notice-meta"},[t("span",[e._v("发布时间："+e._s(e.formatDate(e.currentNotice.createTime)))]),"HIGH"===e.currentNotice.priority?t("span",{staticClass:"notice-priority"},[t("i",{staticClass:"el-icon-warning"}),e._v(" 重要通知 ")]):e._e()]),t("div",{staticClass:"notice-content"},[e._v(e._s(e.currentNotice.content))])])],1)},be=[],ve={name:"NoticeManagement",data(){return{searchKeyword:"",searchType:"",noticeList:[],loading:!1,dialogVisible:!1,viewDialogVisible:!1,dialogTitle:"",currentNotice:{},page:{current:1,size:10,total:0},form:{id:null,type:"OTHER",priority:"NORMAL",title:"",content:"",status:1,createTime:null,updateTime:null,createBy:this.$store.state.user.id},rules:{type:[{required:!0,message:"请选择通知类型",trigger:"change"}],priority:[{required:!0,message:"请选择重要程度",trigger:"change"}],title:[{required:!0,message:"请输入标题",trigger:"blur"},{max:100,message:"长度不能超过100个字符",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"},{max:2e3,message:"长度不能超过2000个字符",trigger:"blur"}]}}},created(){this.fetchNoticeList()},methods:{formatDate(e){return e?new Date(e).toLocaleString():""},getTypeTagType(e){const t={TEST_SCHEDULE:"primary",SCORE_RELEASE:"success",SYSTEM_MAINTENANCE:"warning",OTHER:"info"};return t[e]||"info"},getTypeLabel(e){const t={TEST_SCHEDULE:"体测安排",SCORE_RELEASE:"成绩公布",SYSTEM_MAINTENANCE:"系统维护",OTHER:"其他通知"};return t[e]||"其他通知"},async fetchNoticeList(){try{this.loading=!0,console.log("Fetching notices...");const e=await this.$http.get("/api/admin/notices",{params:{keyword:this.searchKeyword,page:this.page.current-1,size:this.page.size}});console.log("Response:",e.data),200===e.data.code?Array.isArray(e.data.data)?(this.noticeList=e.data.data,this.page.total=e.data.data.length):e.data.data.content&&(this.noticeList=e.data.data.content,this.page.total=e.data.data.totalElements):this.$message.error(e.data.msg||"获取通知列表失败")}catch(e){console.error("获取通知列表失败:",e),this.$message.error("获取通知列表失败")}finally{this.loading=!1}},handleSearch(){this.page.current=1,this.fetchNoticeList()},handleSizeChange(e){this.page.size=e,this.fetchNoticeList()},handleCurrentChange(e){this.page.current=e,this.fetchNoticeList()},handleAdd(){this.dialogTitle="发布通知",this.form={id:null,type:"OTHER",priority:"NORMAL",title:"",content:"",status:1,createTime:null,updateTime:null,createBy:this.$store.state.user.id},this.dialogVisible=!0},handleView(e){this.currentNotice={...e},this.viewDialogVisible=!0},handleEdit(e){this.dialogTitle="编辑通知",this.form={...e},this.dialogVisible=!0},async handleSubmit(){this.$refs.form.validate(async e=>{if(e)try{const e=this.form.id?"/api/admin/notices/"+this.form.id:"/api/admin/notices",t=this.form.id?"put":"post",a=await this.$http[t](e,this.form);200===a.data.code?(this.$message.success(this.form.id?"更新成功":"添加成功"),this.dialogVisible=!1,this.fetchNoticeList()):this.$message.error(a.data.msg||"操作失败")}catch(a){var t;console.error("操作失败:",a),this.$message.error((null===(t=a.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.msg)||"操作失败")}})},async handleDelete(e){try{await this.$confirm("确认删除该通知吗？","提示",{type:"warning"});const t=await this.$http.delete("/api/admin/notices/"+e.id);200===t.data.code&&(this.$message.success("删除成功"),this.fetchNoticeList())}catch(t){"cancel"!==t&&this.$message.error("删除失败")}},async handleStatusChange(e){try{const t=await this.$http.put(`/admin/notices/${e.id}/status`,{status:e.status});200===t.data.code?this.$message.success((1===e.status?"启用":"禁用")+"成功"):(e.status=1===e.status?0:1,this.$message.error(t.data.msg||"操作失败"))}catch(t){e.status=1===e.status?0:1,this.$message.error("操作失败")}}}},ye=ve,we=(a("6fd7"),Object(n["a"])(ye,ge,be,!1,null,"285c75a9",null)),_e=we.exports,ke=function(){var e=this,t=e._self._c;return t("div",{staticClass:"profile"},[t("el-card",{staticClass:"profile-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("个人信息")]),t("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:e.handleEdit}},[e._v(" 修改 ")])],1),t("el-form",{attrs:{"label-width":"80px",model:e.userInfo,disabled:!e.isEditing}},[t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{disabled:""},model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}})],1),t("el-form-item",{attrs:{label:"姓名"}},[t("el-input",{model:{value:e.userInfo.realName,callback:function(t){e.$set(e.userInfo,"realName",t)},expression:"userInfo.realName"}})],1),t("el-form-item",{attrs:{label:"邮箱"}},[t("el-input",{model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1),t("el-form-item",{attrs:{label:"手机号"}},[t("el-input",{model:{value:e.userInfo.phone,callback:function(t){e.$set(e.userInfo,"phone",t)},expression:"userInfo.phone"}})],1)],1),e.isEditing?t("div",{staticClass:"button-group"},[t("el-button",{on:{click:function(t){e.isEditing=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.handleSave}},[e._v("保存")])],1):e._e()],1),t("el-card",{staticClass:"password-card"},[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",[e._v("修改密码")])]),t("el-form",{ref:"passwordForm",attrs:{model:e.passwordForm,rules:e.passwordRules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"原密码",prop:"oldPassword"}},[t("el-input",{attrs:{type:"password"},model:{value:e.passwordForm.oldPassword,callback:function(t){e.$set(e.passwordForm,"oldPassword",t)},expression:"passwordForm.oldPassword"}})],1),t("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[t("el-input",{attrs:{type:"password"},model:{value:e.passwordForm.newPassword,callback:function(t){e.$set(e.passwordForm,"newPassword",t)},expression:"passwordForm.newPassword"}})],1),t("el-form-item",{attrs:{label:"确认新密码",prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password"},model:{value:e.passwordForm.confirmPassword,callback:function(t){e.$set(e.passwordForm,"confirmPassword",t)},expression:"passwordForm.confirmPassword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleChangePassword}},[e._v("修改密码")])],1)],1)],1)],1)},Se=[],Ce=(a("d9e2"),a("2f62")),Ee={name:"Profile",data(){const e=(e,t,a)=>{t!==this.passwordForm.newPassword?a(new Error("两次输入的密码不一致")):a()};return{isEditing:!1,passwordForm:{oldPassword:"",newPassword:"",confirmPassword:""},passwordRules:{oldPassword:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度不能小于6位",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:e,trigger:"blur"}]}}},computed:{...Object(Ce["b"])({userInfo:e=>e.user})},methods:{handleEdit(){this.isEditing=!0},async handleSave(){try{const e=await this.$http.put("/api/admin/users/update",this.userInfo);200===e.data.code?(this.$message.success("保存成功"),this.isEditing=!1,this.$store.dispatch("setUser",this.userInfo)):this.$message.error(e.data.msg)}catch(e){this.$message.error("保存失败")}},async handleChangePassword(){this.$refs.passwordForm.validate(async e=>{if(e)try{const e={userId:this.userInfo.id,oldPassword:this.passwordForm.oldPassword,newPassword:this.passwordForm.newPassword},t=await this.$http.put("/api/auth/change-password",e);200===t.data.code?(this.$message.success("密码修改成功，请重新登录"),this.$store.dispatch("clearUser"),this.$router.push("/login")):this.$message.error(t.data.msg)}catch(t){this.$message.error("修改密码失败")}})}}},$e=Ee,Te=(a("7a67"),Object(n["a"])($e,ke,Se,!1,null,"2c68ba63",null)),xe=(Te.exports,function(){var e=this,t=e._self._c;return t("div",{staticClass:"data-review"},[t("div",{staticClass:"header"},[t("h2",[e._v("数据录入与审核")]),t("div",{staticClass:"actions"},[t("el-button",{attrs:{type:"primary"},on:{click:e.showAddDialog}},[t("i",{staticClass:"el-icon-plus"}),e._v(" 录入成绩 ")]),t("el-button",{attrs:{type:"success"},on:{click:e.exportData}},[t("i",{staticClass:"el-icon-download"}),e._v(" 导出数据 ")])],1)]),t("div",{staticClass:"filters"},[t("el-form",{staticClass:"filter-form",attrs:{inline:!0}},[t("el-form-item",{attrs:{label:"测试项目"}},[t("el-select",{attrs:{placeholder:"选择测试项目",clearable:""},model:{value:e.filters.sportsItemId,callback:function(t){e.$set(e.filters,"sportsItemId",t)},expression:"filters.sportsItemId"}},e._l(e.sportsItems,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"状态"}},[t("el-select",{attrs:{placeholder:"选择状态",clearable:""},model:{value:e.filters.status,callback:function(t){e.$set(e.filters,"status",t)},expression:"filters.status"}},[t("el-option",{attrs:{label:"待审核",value:"PENDING"}}),t("el-option",{attrs:{label:"已通过",value:"APPROVED"}}),t("el-option",{attrs:{label:"已驳回",value:"REJECTED"}})],1)],1),t("el-form-item",{attrs:{label:"关键词"}},[t("el-input",{attrs:{placeholder:"学号/姓名",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.filters.keyword,callback:function(t){e.$set(e.filters,"keyword",t)},expression:"filters.keyword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("查询")]),t("el-button",{on:{click:e.resetFilters}},[e._v("重置")])],1)],1)],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.records,border:""}},[t("el-table-column",{attrs:{label:"序号",type:"index",width:"50",align:"center"}}),t("el-table-column",{attrs:{prop:"studentNumber",label:"学号",width:"120"}}),t("el-table-column",{attrs:{prop:"studentName",label:"姓名",width:"120"}}),t("el-table-column",{attrs:{prop:"className",label:"班级",width:"120"}}),t("el-table-column",{attrs:{label:"测试项目",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.sportsItem?t.row.sportsItem.name:"")+" ")]}}])}),t("el-table-column",{attrs:{prop:"score",label:"成绩",width:"100"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.status)}},[e._v(" "+e._s(e.getStatusText(a.row.status))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"reviewComment",label:"审核意见"}}),t("el-table-column",{attrs:{prop:"createdAt",label:"创建时间",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDateTime(t.row.createdAt))+" ")]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.handleEdit(a.row)}}},[e._v("编辑")]),"PENDING"===a.row.status?t("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.handleReview(a.row)}}},[e._v("审核")]):e._e()]}}])})],1),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1),t("el-dialog",{attrs:{title:"录入成绩",visible:e.addDialog.visible,width:"400px"},on:{"update:visible":function(t){return e.$set(e.addDialog,"visible",t)},closed:e.handleDialogClosed}},[t("el-form",{ref:"recordForm",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"学生",prop:"studentId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择学生",filterable:"",remote:"","remote-method":e.searchStudents,loading:e.studentLoading},model:{value:e.form.studentId,callback:function(t){e.$set(e.form,"studentId",t)},expression:"form.studentId"}},e._l(e.students,(function(a){return t("el-option",{key:a.id,attrs:{label:a.realName,value:a.id}},[t("span",[e._v(e._s(a.realName))]),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(" "+e._s(a.username)+" ")])])})),1)],1),t("el-form-item",{attrs:{label:"测试项目",prop:"sportsItemId"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目"},on:{change:e.handleSportsItemChange},model:{value:e.form.sportsItemId,callback:function(t){e.$set(e.form,"sportsItemId",t)},expression:"form.sportsItemId"}},e._l(e.sportsItems,(function(a){return t("el-option",{key:a.id,attrs:{label:a.name,value:a.id}},[t("span",[e._v(e._s(a.name))]),t("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(" "+e._s(a.unit)+" ")])])})),1)],1),t("el-form-item",{attrs:{label:"成绩",prop:"score"}},[t("div",{staticStyle:{display:"flex","align-items":"center"}},[t("el-input-number",{staticStyle:{width:"160px"},attrs:{precision:2,step:.1,min:0,"controls-position":"right"},model:{value:e.form.score,callback:function(t){e.$set(e.form,"score",t)},expression:"form.score"}}),t("span",{staticStyle:{"margin-left":"10px",color:"#606266"}},[e._v(e._s(e.selectedItemUnit))])],1)]),t("el-form-item",{attrs:{label:"班级",prop:"className"}},[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择班级"},model:{value:e.form.className,callback:function(t){e.$set(e.form,"className",t)},expression:"form.className"}},e._l(e.classList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.addDialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1),t("el-dialog",{attrs:{title:"成绩审核",visible:e.reviewDialog.visible,width:"500px"},on:{"update:visible":function(t){return e.$set(e.reviewDialog,"visible",t)}}},[e.currentRecord?t("div",{staticClass:"review-info"},[t("el-descriptions",{attrs:{column:2,border:""}},[t("el-descriptions-item",{attrs:{label:"学生"}},[e._v(e._s(e.currentRecord.student?e.currentRecord.student.realName:"-")+" ("+e._s(e.currentRecord.studentNumber||"-")+")")]),t("el-descriptions-item",{attrs:{label:"测试项目"}},[e._v(e._s(e.currentRecord.sportsItem?e.currentRecord.sportsItem.name:"-"))]),t("el-descriptions-item",{attrs:{label:"测试成绩"}},[e._v(e._s(e.currentRecord.score||"-")+" "+e._s(e.currentRecord.sportsItem?e.currentRecord.sportsItem.unit:""))]),t("el-descriptions-item",{attrs:{label:"班级"}},[e._v(e._s(e.currentRecord.className||"-"))]),t("el-descriptions-item",{attrs:{label:"录入教师"}},[e._v(e._s(e.currentRecord.teacher?e.currentRecord.teacher.realName:"-"))]),t("el-descriptions-item",{attrs:{label:"录入时间"}},[e._v(e._s(e.formatDateTime(e.currentRecord.createdAt)))])],1)],1):e._e(),t("el-form",{ref:"reviewForm",staticClass:"review-form",attrs:{model:e.reviewForm,rules:e.reviewRules}},[t("el-form-item",{attrs:{label:"审核结果",prop:"status"}},[t("el-radio-group",{model:{value:e.reviewForm.status,callback:function(t){e.$set(e.reviewForm,"status",t)},expression:"reviewForm.status"}},[t("el-radio",{attrs:{label:"APPROVED"}},[e._v("通过")]),t("el-radio",{attrs:{label:"REJECTED"}},[e._v("驳回")])],1)],1),t("el-form-item",{attrs:{label:"审核意见",prop:"comment"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入审核意见"},model:{value:e.reviewForm.comment,callback:function(t){e.$set(e.reviewForm,"comment",t)},expression:"reviewForm.comment"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.reviewDialog.visible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitReview}},[e._v("确定")])],1)],1),t("el-dialog",{attrs:{title:"成绩详情",visible:e.detailDialog.visible,width:"600px"},on:{"update:visible":function(t){return e.$set(e.detailDialog,"visible",t)}}},[e.currentRecord?t("div",{staticClass:"detail-container"},[t("el-descriptions",{attrs:{column:2,border:""}},[t("el-descriptions-item",{attrs:{label:"学生姓名"}},[e._v(" "+e._s(e.currentRecord.student?e.currentRecord.student.realName:"-")+" ("+e._s(e.currentRecord.studentNumber||"-")+") ")]),t("el-descriptions-item",{attrs:{label:"学号"}},[e._v(" "+e._s(e.currentRecord.student?e.currentRecord.student.username:"-")+" ")]),t("el-descriptions-item",{attrs:{label:"班级"}},[e._v(" "+e._s(e.currentRecord.className||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"测试项目"}},[e._v(" "+e._s(e.currentRecord.sportsItem?e.currentRecord.sportsItem.name:"-")+" ")]),t("el-descriptions-item",{attrs:{label:"测试成绩"}},[e._v(" "+e._s(e.currentRecord.score||"-")+" "+e._s(e.currentRecord.sportsItem?e.currentRecord.sportsItem.unit:"")+" ")]),t("el-descriptions-item",{attrs:{label:"记录教师"}},[e._v(" "+e._s(e.currentRecord.teacher?e.currentRecord.teacher.realName:"-")+" ")]),t("el-descriptions-item",{attrs:{label:"审核状态"}},[t("el-tag",{attrs:{type:e.getStatusType(e.currentRecord.status)}},[e._v(" "+e._s(e.getStatusText(e.currentRecord.status))+" ")])],1),t("el-descriptions-item",{attrs:{label:"审核时间"}},[e._v(" "+e._s(e.formatDateTime(e.currentRecord.reviewTime)||"-")+" ")]),t("el-descriptions-item",{attrs:{label:"审核意见",span:2}},[e._v(" "+e._s(e.currentRecord.reviewComment||"-")+" ")])],1),e.historyRecords.length>0?t("div",{staticClass:"history-records"},[t("h3",[e._v("历史成绩记录")]),t("el-table",{attrs:{data:e.historyRecords,size:"small",border:"",stripe:""}},[t("el-table-column",{attrs:{label:"测试时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.formatDateTime(t.row.testTime))+" ")]}}],null,!1,2855166621)}),t("el-table-column",{attrs:{label:"成绩",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.score||"-")+" "+e._s(t.row.sportsItem?t.row.sportsItem.unit:"")+" ")]}}],null,!1,2094687960)}),t("el-table-column",{attrs:{label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.status)}},[e._v(" "+e._s(e.getStatusText(a.row.status))+" ")])]}}],null,!1,2263538733)})],1)],1):e._e()],1):e._e()]),t("el-dialog",{attrs:{title:"修改审核状态",visible:e.modifyDialog.visible,width:"400px"},on:{"update:visible":function(t){return e.$set(e.modifyDialog,"visible",t)}}},[t("div",{staticClass:"review-info"},[t("p",[e._v("学生："+e._s(e.currentRecord&&e.currentRecord.student?e.currentRecord.student.realName:"-")+" ("+e._s(e.currentRecord?e.currentRecord.studentNumber:"-")+")")]),t("p",[e._v("项目："+e._s(e.currentRecord&&e.currentRecord.sportsItem?e.currentRecord.sportsItem.name:"-"))]),t("p",[e._v("成绩："+e._s(e.currentRecord?e.currentRecord.score:"-")+" "+e._s(e.currentRecord&&e.currentRecord.sportsItem?e.currentRecord.sportsItem.unit:""))])]),t("el-form",{ref:"modifyForm",attrs:{model:e.modifyForm,rules:e.modifyRules,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"审核状态",prop:"status"}},[t("el-select",{attrs:{placeholder:"请选择审核状态"},model:{value:e.modifyForm.status,callback:function(t){e.$set(e.modifyForm,"status",t)},expression:"modifyForm.status"}},[t("el-option",{attrs:{label:"待审核",value:"PENDING"}}),t("el-option",{attrs:{label:"通过",value:"APPROVED"}}),t("el-option",{attrs:{label:"驳回",value:"REJECTED"}})],1)],1),t("el-form-item",{attrs:{label:"审核意见",prop:"comment"}},[t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入审核意见"},model:{value:e.modifyForm.comment,callback:function(t){e.$set(e.modifyForm,"comment",t)},expression:"modifyForm.comment"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.modifyDialog.visible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitModify}},[e._v("确 定")])],1)],1)],1)}),Ie=[],Re=(a("e9f5"),a("f665"),a("b775"));function De(e){return Object(Re["a"])({url:"/api/admin/test-record",method:"post",data:e})}function Ne(e){return Object(Re["a"])({url:"/api/admin/test-record/review",method:"put",data:e})}function Pe(e){return Object(Re["a"])({url:"/api/admin/test-record/export",method:"get",params:e,responseType:"blob"})}function Fe(e){return Object(Re["a"])({url:"/api/admin/test-record/modify",method:"put",data:e})}var Ae={name:"DataReview",data(){return{loading:!1,records:[],total:0,currentPage:1,pageSize:10,filters:{sportsItemId:void 0,status:void 0,keyword:""},sportsItems:[],classList:[],addDialog:{visible:!1},form:{studentId:null,sportsItemId:null,score:null,className:null},rules:{studentId:[{required:!0,message:"请选择学生",trigger:"change"}],sportsItemId:[{required:!0,message:"请选择测试项目",trigger:"change"}],score:[{required:!0,message:"请输入测试成绩",trigger:"blur"},{type:"number",message:"成绩必须为数字",trigger:"blur"}],className:[{required:!0,message:"请选择班级",trigger:"change"}]},teachers:[],selectedItemUnit:"",students:[],reviewDialog:{visible:!1},currentRecord:null,reviewForm:{id:null,status:"",comment:""},reviewRules:{status:[{required:!0,message:"请选择审核结果",trigger:"change"}],comment:[{required:!0,message:"请输入审核意见",trigger:"blur"}]},studentLoading:!1,detailDialog:{visible:!1},historyRecords:[],modifyDialog:{visible:!1},modifyForm:{id:null,status:"",comment:""},modifyRules:{status:[{required:!0,message:"请选择审核状态",trigger:"change"}],comment:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},created(){this.init()},methods:{async init(){await Promise.all([this.getSportsItems(),this.fetchRecords()])},async fetchRecords(){try{this.loading=!0;const{sportsItemId:e,status:t,keyword:a}=this.filters,s=await this.$http.get("/api/admin/test-records",{params:{sportsItemId:e,status:t,keyword:a,page:this.currentPage-1,size:this.pageSize}});if(200===s.data.code){const{content:e,totalElements:t}=s.data.data;this.records=e,this.total=t}else this.$message.error(s.data.msg||"获取数据失败")}catch(e){console.error("获取记录失败:",e),this.$message.error("获取记录失败")}finally{this.loading=!1}},async getSportsItems(){try{const e=await this.$http.get("/api/admin/sports-items");200===e.data.code&&(this.sportsItems=e.data.data||[])}catch(e){console.error("获取体测项目列表失败:",e),this.$message.error("获取体测项目列表失败")}},handleSearch(){this.currentPage=1,this.fetchRecords()},resetFilters(){this.$refs.filterForm.resetFields(),this.filters={sportsItemId:void 0,status:void 0,keyword:""},this.handleSearch()},getStatusType(e){const t={PENDING:"warning",APPROVED:"success",REJECTED:"danger"};return t[e]||"info"},getStatusText(e){const t={PENDING:"待审核",APPROVED:"已通过",REJECTED:"已驳回"};return t[e]||e},formatDateTime(e){return e?new Date(e).toLocaleString():""},showAddDialog(){this.addDialog.visible=!0},async exportData(){try{await Pe(this.filters)}catch(e){this.$message.error("导出失败："+e.message)}},handleDialogClosed(){this.$refs.recordForm.resetFields()},submitForm(){this.$refs.recordForm.validate(async e=>{if(e)try{const e=await De(this.form);200===e.data.code?(this.$message.success("成绩录入成功"),this.addDialog.visible=!1,this.handleSearch()):this.$message.error(e.data.msg||"录入失败")}catch(t){console.error("录入失败:",t),this.$message.error("录入失败")}})},handleReview(e){this.currentRecord=e,this.reviewDialog.visible=!0},submitReview(){this.$refs.reviewForm.validate(async e=>{if(e)try{const e=await Ne(this.currentRecord.id,this.reviewForm);200===e.data.code?(this.$message.success("审核成功"),this.reviewDialog.visible=!1,this.handleSearch()):this.$message.error(e.data.msg||"审核失败")}catch(t){console.error("审核失败:",t),this.$message.error("审核失败")}})},handleEdit(e){this.currentRecord=e,this.detailDialog.visible=!0},handleSportsItemChange(e){const t=this.sportsItems.find(t=>t.id===e);t&&(this.selectedItemUnit=t.unit)},searchStudents(e){this.studentLoading=!0,this.$http.get("/api/admin/students",{params:{query:e,page:0,size:10}}).then(e=>{200===e.data.code?this.students=e.data.data.content||[]:this.$message.error(e.data.msg||"获取学生列表失败")}).finally(()=>{this.studentLoading=!1})},handleSizeChange(e){this.pageSize=e,this.handleSearch()},handleCurrentChange(e){this.currentPage=e,this.handleSearch()},submitModify(){this.$refs.modifyForm.validate(async e=>{if(e)try{const e=await Fe(this.currentRecord.id,this.modifyForm);200===e.data.code?(this.$message.success("审核状态修改成功"),this.modifyDialog.visible=!1,this.handleSearch()):this.$message.error(e.data.msg||"修改失败")}catch(t){console.error("修改失败:",t),this.$message.error("修改失败")}})}}},ze=Ae,Oe=(a("7b07"),Object(n["a"])(ze,xe,Ie,!1,null,"6fbce9af",null)),Le=Oe.exports,Ve=function(){var e=this,t=e._self._c;return t("div",{staticClass:"test-records"},[t("div",{staticClass:"filter-container"},[t("el-select",{attrs:{placeholder:"状态",clearable:""},model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[t("el-option",{attrs:{label:"全部",value:""}}),t("el-option",{attrs:{label:"待审核",value:"PENDING"}}),t("el-option",{attrs:{label:"已通过",value:"APPROVED"}}),t("el-option",{attrs:{label:"已拒绝",value:"REJECTED"}})],1),t("el-button",{attrs:{type:"primary"},on:{click:e.getTestRecords}},[e._v("查询")]),t("el-button",{on:{click:e.resetQuery}},[e._v("重置")])],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.records,border:""}},[t("el-table-column",{attrs:{prop:"testTime",label:"测试时间",width:"180"}}),t("el-table-column",{attrs:{prop:"sportsItemName",label:"体育项目"}}),t("el-table-column",{attrs:{prop:"score",label:"成绩"}}),t("el-table-column",{attrs:{prop:"grade",label:"等级"}}),t("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusType(a.row.status)}},[e._v(e._s(e.getStatusText(a.row.status)))])]}}])}),t("el-table-column",{attrs:{prop:"reviewComment",label:"审核意见"}})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)},Ue=[],Me={name:"TestRecords",data(){return{status:"",currentPage:1,pageSize:10,total:0,records:[],loading:!1}},created(){this.getTestRecords()},methods:{async getTestRecords(){try{this.loading=!0;const e=localStorage.getItem("userId");console.log("请求参数:",{status:this.status,page:this.currentPage,size:this.pageSize,userId:e});const t=await this.$axios.get("/api/student/test-records",{params:{status:this.status,page:this.currentPage,size:this.pageSize},headers:{userId:e}});console.log("响应数据:",t.data),200===t.data.code?(this.records=t.data.data.content,this.total=t.data.data.totalElements):this.$message.error(t.data.message)}catch(e){console.error("获取测试记录失败:",e),this.$message.error("获取测试记录失败")}finally{this.loading=!1}},handleSizeChange(e){console.log("改变每页数量:",e),this.pageSize=e,this.getTestRecords()},handleCurrentChange(e){console.log("改变页码:",e),this.currentPage=e,this.getTestRecords()},resetQuery(){this.status="",this.currentPage=1,this.getTestRecords()},getStatusType(e){const t={PENDING:"warning",APPROVED:"success",REJECTED:"danger"};return t[e]||"info"},getStatusText(e){const t={PENDING:"待审核",APPROVED:"已通过",REJECTED:"已拒绝"};return t[e]||e}}},je=Me,qe=(a("c2f2"),Object(n["a"])(je,Ve,Ue,!1,null,"8305677c",null)),He=qe.exports;s["default"].use(u["a"]);const Je={path:"/student",component:()=>a.e("chunk-2904a65b").then(a.bind(null,"c774")),meta:{requiresAuth:!0,role:"STUDENT"},children:[{path:"",redirect:"test-records"},{path:"test-records",name:"StudentTestRecords",component:He,meta:{title:"体测成绩"}}]},Ge=[{path:"/login",name:"Login",component:b,meta:{requiresAuth:!1}},{path:"/admin",component:S,meta:{requiresAuth:!0,role:"ADMIN"},children:[{path:"dashboard",name:"AdminDashboard",component:Q},{path:"users/student",name:"StudentManagement",component:se},{path:"users/teacher",name:"TeacherManagement",component:ce},{path:"sports-items",name:"SportsItemManagement",component:fe,meta:{requiresAuth:!0,requiresAdmin:!0}},{path:"notices",name:"NoticeManagement",component:_e},{path:"profile",name:"Profile",component:()=>a.e("chunk-13199d7f").then(a.bind(null,"ecac")),meta:{title:"个人信息",icon:"el-icon-user"}},{path:"data-review",name:"DataReview",component:Le,meta:{title:"数据录入与审核",requiresAuth:!0,role:"ADMIN"}},{path:"exemption-review",name:"ExemptionReview",component:()=>a.e("chunk-61645b83").then(a.bind(null,"2b76")),meta:{title:"免测/重测申请",icon:"el-icon-document-checked"}}]},{path:"/admin/test-records",name:"TestRecordList",component:z,meta:{requiresAuth:!0,roles:["ADMIN"]}},{path:"/admin/users",name:"UserList",component:j,meta:{requiresAuth:!0,roles:["ADMIN"]}},{path:"/teacher",component:()=>a.e("chunk-014840ba").then(a.bind(null,"610b")),meta:{requiresAuth:!0,role:"TEACHER"},children:[{path:"dashboard",name:"TeacherDashboard",component:()=>a.e("chunk-0c9c9b67").then(a.bind(null,"c865")),meta:{title:"首页"}},{path:"class-stats",name:"ClassStats",component:()=>a.e("chunk-3c786940").then(a.bind(null,"dac2")),meta:{title:"班级成绩统计"}},{path:"student-records",name:"StudentRecords",component:()=>a.e("chunk-58f0b7c2").then(a.bind(null,"1bd6")),meta:{title:"学生成绩管理"}},{path:"exemption-review",name:"TeacherExemptionReview",component:()=>a.e("chunk-58dfa14e").then(a.bind(null,"a245")),meta:{title:"免测/重测审核"}},{path:"profile",name:"TeacherProfile",component:()=>a.e("chunk-13199d7f").then(a.bind(null,"ecac")),meta:{title:"个人信息"}},{path:"student-management",name:"TeacherStudentManagement",component:()=>a.e("chunk-5008bcf5").then(a.bind(null,"2501")),meta:{title:"学生管理",roles:["TEACHER"]}},{path:"notice-management",name:"TeacherNoticeManagement",component:()=>a.e("chunk-e036a840").then(a.bind(null,"762f")),meta:{title:"通知管理",roles:["TEACHER"]}},{path:"/teacher/student-records",name:"TeacherStudentRecords",component:()=>a.e("chunk-58f0b7c2").then(a.bind(null,"1bd6")),meta:{title:"学生成绩管理",roles:["TEACHER"]}}]},Je,{path:"/",redirect:e=>{const t=localStorage.getItem("token"),a=localStorage.getItem("userRole");if(!t)return"/login";switch(a){case"STUDENT":return"/student/test-records";case"TEACHER":return"/teacher/dashboard";case"ADMIN":return"/admin/dashboard";default:return"/login"}}}],Be=new u["a"]({mode:"history",base:"/",routes:Ge});Be.beforeEach((e,t,a)=>{const s=localStorage.getItem("token"),r=localStorage.getItem("userRole");if("/login"===e.path)if(s)switch(r){case"STUDENT":a("/student/test-records");break;case"TEACHER":a("/teacher/dashboard");break;case"ADMIN":a("/admin/dashboard");break;default:a()}else a();else if(s){const t=e.meta.role;if(t&&t!==r)switch(r){case"STUDENT":a("/student/test-records");break;case"TEACHER":a("/teacher/dashboard");break;case"ADMIN":a("/admin/dashboard");break;default:a("/login")}else a()}else a("/login")});var Ke=Be;s["default"].use(Ce["a"]);var Ye=new Ce["a"].Store({state:{user:JSON.parse(localStorage.getItem("user"))||null},mutations:{SET_USER(e,t){e.user=t,t?localStorage.setItem("user",JSON.stringify(t)):localStorage.removeItem("user")}},actions:{setUser({commit:e},t){e("SET_USER",t)},clearUser({commit:e}){e("SET_USER",null)}},getters:{isLoggedIn:e=>!!e.user,userType:e=>e.user?e.user.userType:null}}),Qe=a("5c96"),We=a.n(Qe),Xe=(a("0fae"),a("bc3a")),Ze=a.n(Xe);s["default"].use(We.a,{tableOptions:{mousewheel:{passive:!0}}}),s["default"].config.productionTip=!1,Ze.a.defaults.baseURL=Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_API_URL||"http://localhost:8081",Ze.a.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer "+t),e}),s["default"].prototype.$http=Ze.a,s["default"].prototype.$axios=Re["a"],new s["default"]({router:Ke,store:Ye,render:e=>e(d)}).$mount("#app")},"5a41":function(e,t,a){"use strict";a("7ab9")},"6fd7":function(e,t,a){"use strict";a("e5dc")},"749e":function(e,t,a){"use strict";a("0d4f")},"7a67":function(e,t,a){"use strict";a("7e35")},"7ab9":function(e,t,a){},"7b07":function(e,t,a){"use strict";a("341e")},"7e35":function(e,t,a){},"7e79":function(e,t,a){"use strict";a("3bd8")},"82e5":function(e,t,a){"use strict";var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-form"},[t("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[e.isEdit?e._e():t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"用户类型",prop:"userType"}},[t("el-select",{attrs:{placeholder:"请选择用户类型"},model:{value:e.form.userType,callback:function(t){e.$set(e.form,"userType",t)},expression:"form.userType"}},[t("el-option",{attrs:{label:"学生",value:"STUDENT"}}),t("el-option",{attrs:{label:"教师",value:"TEACHER"}})],1)],1),t("el-form-item",{attrs:{label:"姓名",prop:"realName"}},[t("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.form.realName,callback:function(t){e.$set(e.form,"realName",t)},expression:"form.realName"}})],1),"STUDENT"===e.userType?t("el-form-item",{attrs:{label:"学号",prop:"studentNumber"}},[t("el-input",{attrs:{placeholder:"请输入学号"},model:{value:e.form.studentNumber,callback:function(t){e.$set(e.form,"studentNumber",t)},expression:"form.studentNumber"}})],1):e._e(),t("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[t("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),t("el-form-item",{attrs:{label:"电话",prop:"phone"}},[t("el-input",{attrs:{placeholder:"请输入电话"},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("保存")]),t("el-button",{on:{click:e.resetForm}},[e._v("重置")])],1)],1)],1)},r=[],i={name:"UserForm",props:{userType:{type:String,required:!0}},data(){return{isEdit:!1,form:{id:null,username:"",userType:"",realName:"",studentNumber:"",email:"",phone:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],userType:[{required:!0,message:"请选择用户类型",trigger:"change"}],realName:[{required:!0,message:"请输入姓名",trigger:"blur"}],studentNumber:[{required:!0,message:"请输入学号",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]}}},methods:{setFormData(e){this.isEdit=!0,this.form={...e}},submitForm(){this.$refs.form.validate(async e=>{if(e)try{const e=this.isEdit?"/api/admin/users/"+this.form.id:"/api/admin/users",t=this.isEdit?"put":"post";this.form.userType=this.userType;const a=await this.$axios[t](e,this.form);200===a.data.code?(this.$message.success("保存成功"),this.$emit("saved"),this.resetForm()):this.$message.error(a.data.msg||"保存失败")}catch(t){this.$message.error("保存失败："+t.message)}})},resetForm(){this.$refs.form.resetFields(),this.isEdit=!1,this.form={id:null,username:"",userType:"",realName:"",studentNumber:"",email:"",phone:""}}},watch:{"form.userType"(e){"STUDENT"!==e&&(this.form.studentNumber="")}}},o=i,l=(a("a6ec"),a("2877")),n=Object(l["a"])(o,s,r,!1,null,"24a52aea",null);t["a"]=n.exports},a6ec:function(e,t,a){"use strict";a("d166")},b18b:function(e,t,a){"use strict";a("356c")},b1ef:function(e,t,a){},b775:function(e,t,a){"use strict";a("d9e2");var s=a("bc3a"),r=a.n(s),i=a("5c96");const o=r.a.create({baseURL:"http://localhost:8080",timeout:5e3});o.interceptors.request.use(e=>{const t=localStorage.getItem("token"),a=localStorage.getItem("userId");return t&&(e.headers["Authorization"]="Bearer "+t),a&&(e.headers["userId"]=a),e},e=>(console.error("请求错误:",e),Promise.reject(e))),o.interceptors.response.use(e=>{const t=e.data;return 200!==t.code?(Object(i["Message"])({message:t.msg||"错误",type:"error",duration:5e3}),Promise.reject(new Error(t.msg||"错误"))):e},e=>(console.error("响应错误:",e),Object(i["Message"])({message:e.message||"请求失败",type:"error",duration:5e3}),Promise.reject(e))),t["a"]=o},bf2b:function(e,t,a){},c2f2:function(e,t,a){"use strict";a("bf2b")},c69b:function(e,t,a){},cb98:function(e,t,a){"use strict";a("e737")},d166:function(e,t,a){},e203:function(e,t,a){},e5dc:function(e,t,a){},e737:function(e,t,a){}});
//# sourceMappingURL=app.31e5ea2e.js.map