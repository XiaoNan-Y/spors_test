(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c1d6e44a"],{"2d59":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"feedback-management"},[t("div",{staticClass:"search-bar"},[t("el-form",{attrs:{inline:!0,model:e.searchForm}},[t("el-form-item",{attrs:{label:"反馈类型"}},[t("el-select",{attrs:{placeholder:"选择类型",clearable:""},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},[t("el-option",{attrs:{label:"功能建议",value:"SUGGESTION"}}),t("el-option",{attrs:{label:"问题反馈",value:"BUG"}}),t("el-option",{attrs:{label:"其他",value:"OTHER"}})],1)],1),t("el-form-item",{attrs:{label:"处理状态"}},[t("el-select",{attrs:{placeholder:"选择状态",clearable:""},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[t("el-option",{attrs:{label:"待处理",value:"PENDING"}}),t("el-option",{attrs:{label:"已解决",value:"RESOLVED"}}),t("el-option",{attrs:{label:"处理中",value:"PROCESSING"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.searchFeedbacks}},[e._v("查询")])],1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.feedbackList,border:""}},[t("el-table-column",{attrs:{prop:"studentName",label:"学生姓名",width:"120"}}),t("el-table-column",{attrs:{prop:"studentNumber",label:"学号",width:"120"}}),t("el-table-column",{attrs:{prop:"className",label:"班级",width:"120"}}),t("el-table-column",{attrs:{prop:"title",label:"标题",width:"150"}}),t("el-table-column",{attrs:{prop:"type",label:"类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getTypeTag(a.row.type)}},[e._v(" "+e._s(e.getTypeLabel(a.row.type))+" ")])]}}])}),t("el-table-column",{attrs:{prop:"content",label:"反馈内容"}}),t("el-table-column",{attrs:{prop:"createTime",label:"提交时间",width:"180"}}),t("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-tag",{attrs:{type:e.getStatusTag(a.row.status)}},[e._v(" "+e._s(e.getStatusLabel(a.row.status))+" ")])]}}])}),t("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"primary",size:"small",disabled:"CLOSED"===a.row.status},on:{click:function(t){return e.handleReply(a.row)}}},[e._v(" 回复 ")]),t("el-button",{attrs:{type:"danger",size:"small",disabled:"CLOSED"===a.row.status},on:{click:function(t){return e.handleClose(a.row)}}},[e._v(" 关闭 ")])]}}])})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"current-change":e.handlePageChange}})],1),t("el-dialog",{attrs:{title:"回复反馈",visible:e.replyDialogVisible,width:"50%"},on:{"update:visible":function(t){e.replyDialogVisible=t}}},[t("el-form",{attrs:{model:e.replyForm,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"反馈内容"}},[t("div",{staticClass:"feedback-content"},[e._v(e._s(e.currentFeedback?e.currentFeedback.content:""))])]),t("el-form-item",{attrs:{label:"回复内容"}},[t("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入回复内容"},model:{value:e.replyForm.reply,callback:function(t){e.$set(e.replyForm,"reply",t)},expression:"replyForm.reply"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.replyDialogVisible=!1}}},[e._v("取消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.submitReply}},[e._v("确定")])],1)],1)],1)},l=[],r={name:"FeedbackManagement",data(){return{feedbackList:[],total:0,currentPage:1,pageSize:10,replyDialogVisible:!1,currentFeedback:null,searchForm:{type:"",status:""},replyForm:{reply:""}}},created(){this.getFeedbacks()},methods:{async getFeedbacks(){try{console.log("Fetching feedbacks...",{type:this.searchForm.type,status:this.searchForm.status,page:this.currentPage,size:this.pageSize});const e=await this.$axios.get("/api/admin/feedback",{params:{type:this.searchForm.type,status:this.searchForm.status,page:this.currentPage,size:this.pageSize}});console.log("Response:",e.data),200===e.data.code?(this.feedbackList=e.data.data.content,this.total=e.data.data.totalElements,console.log("Feedbacks loaded:",this.feedbackList)):this.$message.error(e.data.message||"获取数据失败")}catch(t){var e;console.error("Error fetching feedbacks:",t),this.$message.error("获取反馈列表失败: "+((null===(e=t.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.message)||t.message))}},searchFeedbacks(){this.currentPage=1,this.getFeedbacks()},handleReply(e){this.currentFeedback=e,this.replyForm.reply="",this.replyDialogVisible=!0},async submitReply(){if(this.replyForm.reply.trim())try{const e=await this.$axios.put(`/api/admin/feedback/${this.currentFeedback.id}/reply`,{reply:this.replyForm.reply});200===e.data.code&&(this.$message.success("回复成功"),this.replyDialogVisible=!1,this.getFeedbacks())}catch(e){this.$message.error("回复失败")}else this.$message.warning("请输入回复内容")},handleClose(e){this.$confirm("确定要关闭该反馈吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const t=await this.$axios.put(`/api/admin/feedback/${e.id}/status`,null,{params:{status:"CLOSED"}});200===t.data.code&&(this.$message.success("操作成功"),this.getFeedbacks())}catch(t){this.$message.error("操作失败")}}).catch(()=>{})},handlePageChange(e){this.currentPage=e,this.getFeedbacks()},getTypeLabel(e){const t={SUGGESTION:"功能建议",BUG:"问题反馈",OTHER:"其他"};return t[e]||e},getTypeTag(e){const t={SUGGESTION:"success",BUG:"danger",OTHER:"info"};return t[e]||""},getStatusLabel(e){const t={PENDING:"待处理",PROCESSING:"处理中",RESOLVED:"已解决"};return t[e]||e},getStatusTag(e){const t={PENDING:"warning",PROCESSING:"primary",RESOLVED:"success"};return t[e]||""}}},o=r,i=(a("927b"),a("2877")),n=Object(i["a"])(o,s,l,!1,null,"046f027c",null);t["default"]=n.exports},"927b":function(e,t,a){"use strict";a("a8b7")},a8b7:function(e,t,a){}}]);
//# sourceMappingURL=chunk-c1d6e44a.84800fe4.js.map