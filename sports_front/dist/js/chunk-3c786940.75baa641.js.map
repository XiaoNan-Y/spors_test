{"version":3,"sources":["webpack:///./src/views/teacher/ClassStats.vue?d307","webpack:///./src/views/teacher/ClassStats.vue","webpack:///src/views/teacher/ClassStats.vue","webpack:///./src/views/teacher/ClassStats.vue?62c5","webpack:///./src/views/teacher/ClassStats.vue?7269"],"names":["render","_vm","this","_c","_self","staticClass","attrs","filterForm","model","value","className","callback","$$v","$set","expression","_l","classNames","key","sportsItemId","sportsItems","item","id","name","status","on","handleSearch","_v","handleReset","directives","rawName","loading","staticStyle","statistics","scopedSlots","_u","fn","scope","_s","row","averageScore","toFixed","calculateRate","excellentCount","totalCount","passCount","staticRenderFns","data","created","loadClassNames","loadSportsItems","loadStatistics","methods","response","$axios","get","code","error","console","$message","params","log","Error","message","length","warning","_error$response","count","total","component"],"mappings":"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","file":"js/chunk-3c786940.75baa641.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassStats.vue?vue&type=style&index=0&id=52193fee&prod&scoped=true&lang=css\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"class-stats\"},[_c('div',{staticClass:\"filter-section\"},[_c('el-form',{attrs:{\"inline\":true,\"model\":_vm.filterForm}},[_c('el-form-item',{attrs:{\"label\":\"班级\"}},[_c('el-select',{attrs:{\"placeholder\":\"选择班级\",\"clearable\":\"\"},model:{value:(_vm.filterForm.className),callback:function ($$v) {_vm.$set(_vm.filterForm, \"className\", $$v)},expression:\"filterForm.className\"}},_vm._l((_vm.classNames),function(className){return _c('el-option',{key:className,attrs:{\"label\":className,\"value\":className}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"测试项目\"}},[_c('el-select',{attrs:{\"placeholder\":\"选择测试项目\",\"clearable\":\"\"},model:{value:(_vm.filterForm.sportsItemId),callback:function ($$v) {_vm.$set(_vm.filterForm, \"sportsItemId\", $$v)},expression:\"filterForm.sportsItemId\"}},_vm._l((_vm.sportsItems),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.id}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"状态\"}},[_c('el-select',{attrs:{\"placeholder\":\"选择状态\",\"clearable\":\"\"},model:{value:(_vm.filterForm.status),callback:function ($$v) {_vm.$set(_vm.filterForm, \"status\", $$v)},expression:\"filterForm.status\"}},[_c('el-option',{attrs:{\"label\":\"待审核\",\"value\":\"PENDING\"}}),_c('el-option',{attrs:{\"label\":\"已通过\",\"value\":\"APPROVED\"}}),_c('el-option',{attrs:{\"label\":\"已驳回\",\"value\":\"REJECTED\"}})],1)],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSearch}},[_vm._v(\"查询\")]),_c('el-button',{on:{\"click\":_vm.handleReset}},[_vm._v(\"重置\")])],1)],1)],1),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.statistics,\"border\":\"\",\"stripe\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"className\",\"label\":\"班级\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"prop\":\"totalCount\",\"label\":\"总人数\",\"align\":\"center\"}}),_c('el-table-column',{attrs:{\"prop\":\"averageScore\",\"label\":\"平均分\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.averageScore.toFixed(2))+\" \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"优秀率\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(_vm.calculateRate(scope.row.excellentCount, scope.row.totalCount))+\"% \")]}}])}),_c('el-table-column',{attrs:{\"label\":\"及格率\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(_vm.calculateRate(scope.row.passCount, scope.row.totalCount))+\"% \")]}}])})],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"class-stats\">\r\n    <!-- 搜索筛选区 -->\r\n    <div class=\"filter-section\">\r\n      <el-form :inline=\"true\" :model=\"filterForm\">\r\n        <el-form-item label=\"班级\">\r\n          <el-select v-model=\"filterForm.className\" placeholder=\"选择班级\" clearable>\r\n            <el-option\r\n              v-for=\"className in classNames\"\r\n              :key=\"className\"\r\n              :label=\"className\"\r\n              :value=\"className\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"测试项目\">\r\n          <el-select v-model=\"filterForm.sportsItemId\" placeholder=\"选择测试项目\" clearable>\r\n            <el-option\r\n              v-for=\"item in sportsItems\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"状态\">\r\n          <el-select v-model=\"filterForm.status\" placeholder=\"选择状态\" clearable>\r\n            <el-option label=\"待审核\" value=\"PENDING\"></el-option>\r\n            <el-option label=\"已通过\" value=\"APPROVED\"></el-option>\r\n            <el-option label=\"已驳回\" value=\"REJECTED\"></el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"handleSearch\">查询</el-button>\r\n          <el-button @click=\"handleReset\">重置</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </div>\r\n\r\n    <!-- 数据表格 -->\r\n    <el-table\r\n      v-loading=\"loading\"\r\n      :data=\"statistics\"\r\n      border\r\n      stripe\r\n      style=\"width: 100%\">\r\n      <el-table-column\r\n        prop=\"className\"\r\n        label=\"班级\"\r\n        align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"totalCount\"\r\n        label=\"总人数\"\r\n        align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column\r\n        prop=\"averageScore\"\r\n        label=\"平均分\"\r\n        align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          {{ scope.row.averageScore.toFixed(2) }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"优秀率\"\r\n        align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          {{ calculateRate(scope.row.excellentCount, scope.row.totalCount) }}%\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column\r\n        label=\"及格率\"\r\n        align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          {{ calculateRate(scope.row.passCount, scope.row.totalCount) }}%\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'ClassStats',\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      statistics: [],\r\n      classNames: [],\r\n      sportsItems: [],\r\n      filterForm: {\r\n        className: '',\r\n        sportsItemId: '',\r\n        status: 'APPROVED'  // 默认统计已通过的记录\r\n      }\r\n    }\r\n  },\r\n  created() {\r\n    this.loadClassNames()\r\n    this.loadSportsItems()\r\n    this.loadStatistics()\r\n  },\r\n  methods: {\r\n    async loadClassNames() {\r\n      try {\r\n        const response = await this.$axios.get('/api/teacher/classes')\r\n        if (response.data.code === 200) {\r\n          this.classNames = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取班级列表失败:', error)\r\n        this.$message.error('获取班级列表失败')\r\n      }\r\n    },\r\n    async loadSportsItems() {\r\n      try {\r\n        const response = await this.$axios.get('/api/teacher/sports-items')\r\n        if (response.data.code === 200) {\r\n          this.sportsItems = response.data.data\r\n        }\r\n      } catch (error) {\r\n        console.error('获取体育项目列表失败:', error)\r\n        this.$message.error('获取体育项目列表失败')\r\n      }\r\n    },\r\n    async loadStatistics() {\r\n      this.loading = true;\r\n      try {\r\n        const params = {\r\n          className: this.filterForm.className || '',\r\n          sportsItemId: this.filterForm.sportsItemId || '',\r\n          status: this.filterForm.status || ''\r\n        };\r\n        console.log('发送统计查询参数:', params);\r\n        \r\n        const response = await this.$axios.get('/api/teacher/statistics/class', { params });\r\n        console.log('统计数据原始响应:', response);\r\n        \r\n        if (response.data.code === 200) {\r\n          this.statistics = response.data.data;\r\n          console.log('处理后的统计数据:', this.statistics);\r\n          \r\n          if (this.statistics.length === 0) {\r\n            this.$message.warning('没有找到符合条件的统计数据');\r\n          }\r\n        } else {\r\n          throw new Error(response.data.message || '获取统计数据失败');\r\n        }\r\n      } catch (error) {\r\n        console.error('获取统计数据失败:', error);\r\n        this.$message.error('获取统计数据失败: ' + (error.response?.data?.message || error.message));\r\n      } finally {\r\n        this.loading = false;\r\n      }\r\n    },\r\n    handleSearch() {\r\n      this.loadStatistics()\r\n    },\r\n    handleReset() {\r\n      this.filterForm = {\r\n        className: '',\r\n        sportsItemId: '',\r\n        status: 'APPROVED'  // 重置时恢复默认值\r\n      };\r\n      this.loadStatistics()\r\n    },\r\n    calculateRate(count, total) {\r\n      if (!total) return '0.00'\r\n      return ((count / total) * 100).toFixed(2)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.class-stats {\r\n  padding: 20px;\r\n}\r\n\r\n.filter-section {\r\n  background-color: #f5f7fa;\r\n  padding: 20px;\r\n  border-radius: 4px;\r\n  margin-bottom: 20px;\r\n}\r\n</style> ","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassStats.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ClassStats.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ClassStats.vue?vue&type=template&id=52193fee&scoped=true\"\nimport script from \"./ClassStats.vue?vue&type=script&lang=js\"\nexport * from \"./ClassStats.vue?vue&type=script&lang=js\"\nimport style0 from \"./ClassStats.vue?vue&type=style&index=0&id=52193fee&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"52193fee\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}