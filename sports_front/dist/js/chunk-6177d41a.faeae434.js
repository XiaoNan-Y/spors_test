(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6177d41a"],{"8e05":function(e,t,r){"use strict";r("b187")},a245:function(e,t,r){"use strict";r.r(t);var a=function(){var e,t,r,a,i,s,l,o,n,u,c,d,m,v,p,g,h,b=this,w=b._self._c;return w("div",{staticClass:"exemption-review"},[b._m(0),w("div",{staticClass:"filter-section"},[w("el-form",{ref:"queryForm",attrs:{inline:!0,model:b.queryParams}},[w("el-form-item",{attrs:{label:"关键字"}},[w("el-input",{attrs:{placeholder:"学生姓名/学号",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&b._k(e.keyCode,"enter",13,e.key,"Enter")?null:b.handleQuery.apply(null,arguments)}},model:{value:b.queryParams.keyword,callback:function(e){b.$set(b.queryParams,"keyword",e)},expression:"queryParams.keyword"}})],1),w("el-form-item",[w("el-button",{attrs:{type:"primary"},on:{click:b.handleQuery}},[b._v("查询")]),w("el-button",{on:{click:b.resetQuery}},[b._v("重置")])],1)],1)],1),w("el-table",{directives:[{name:"loading",rawName:"v-loading",value:b.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:b.tableData,border:"",stripe:""}},[w("el-table-column",{attrs:{type:"index",label:"序号",width:"60",align:"center"}}),w("el-table-column",{attrs:{label:"学生姓名",prop:"studentName","min-width":"100",align:"center"}}),w("el-table-column",{attrs:{label:"学号",prop:"studentNumber","min-width":"120",align:"center"}}),w("el-table-column",{attrs:{label:"班级",prop:"className","min-width":"100",align:"center"}}),w("el-table-column",{attrs:{label:"测试项目","min-width":"120",align:"center"},scopedSlots:b._u([{key:"default",fn:function(e){return[b._v(" "+b._s(e.row.sportsItemName||"-")+" ")]}}])}),w("el-table-column",{attrs:{label:"申请原因",prop:"reason","min-width":"200","show-overflow-tooltip":""}}),w("el-table-column",{attrs:{label:"状态",width:"100",align:"center"},scopedSlots:b._u([{key:"default",fn:function(e){return[w("el-tag",{attrs:{type:b.getStatusType(e.row.status)}},[b._v(" "+b._s(b.getStatusText(e.row.status))+" ")])]}}])}),w("el-table-column",{attrs:{label:"申请时间",width:"160",align:"center"},scopedSlots:b._u([{key:"default",fn:function(e){return[b._v(" "+b._s(b.formatDateTime(e.row.applyTime))+" ")]}}])}),w("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:b._u([{key:"default",fn:function(e){return["PENDING"===e.row.status?w("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return b.handleReview(e.row)}}},[b._v("审核")]):b._e(),w("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(t){return b.handleDetail(e.row)}}},[b._v("查看")])]}}])})],1),w("div",{staticClass:"pagination-container"},[w("el-pagination",{attrs:{"current-page":b.queryParams.pageNum,"page-sizes":[10,20,50,100],"page-size":b.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:b.total},on:{"size-change":b.handleSizeChange,"current-change":b.handleCurrentChange}})],1),w("el-dialog",{attrs:{title:"审核重测申请",visible:b.reviewDialog.visible,width:"500px"},on:{"update:visible":function(e){return b.$set(b.reviewDialog,"visible",e)}}},[w("div",{staticClass:"review-info"},[w("p",[w("strong",[b._v("学生信息：")]),b._v(b._s(null===(e=b.currentRecord)||void 0===e?void 0:e.studentName)+" ("+b._s(null===(t=b.currentRecord)||void 0===t?void 0:t.studentNumber)+")")]),w("p",[w("strong",[b._v("班级：")]),b._v(b._s(null===(r=b.currentRecord)||void 0===r?void 0:r.className))]),w("p",[w("strong",[b._v("测试项目：")]),b._v(b._s(null===(a=b.currentRecord)||void 0===a?void 0:a.sportsItemName))]),w("p",[w("strong",[b._v("申请原因：")]),b._v(b._s(null===(i=b.currentRecord)||void 0===i?void 0:i.reason))])]),w("el-form",{ref:"reviewForm",attrs:{model:b.reviewForm,rules:b.reviewRules,"label-width":"100px"}},[w("el-form-item",{attrs:{label:"审核结果",prop:"status"}},[w("el-radio-group",{model:{value:b.reviewForm.status,callback:function(e){b.$set(b.reviewForm,"status",e)},expression:"reviewForm.status"}},[w("el-radio",{attrs:{label:"APPROVED"}},[b._v("通过")]),w("el-radio",{attrs:{label:"REJECTED"}},[b._v("驳回")])],1)],1),w("el-form-item",{attrs:{label:"审核意见",prop:"comment"}},[w("el-input",{attrs:{type:"textarea",rows:4,placeholder:"请输入审核意见"},model:{value:b.reviewForm.comment,callback:function(e){b.$set(b.reviewForm,"comment",e)},expression:"reviewForm.comment"}})],1)],1),w("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[w("el-button",{on:{click:function(e){b.reviewDialog.visible=!1}}},[b._v("取消")]),w("el-button",{attrs:{type:"primary"},on:{click:b.submitReview}},[b._v("确定")])],1)],1),w("el-dialog",{attrs:{title:"申请详情",visible:b.detailDialog.visible,width:"500px"},on:{"update:visible":function(e){return b.$set(b.detailDialog,"visible",e)}}},[w("el-descriptions",{attrs:{column:1,border:""}},[w("el-descriptions-item",{attrs:{label:"学生姓名"}},[b._v(b._s(null===(s=b.currentRecord)||void 0===s?void 0:s.studentName))]),w("el-descriptions-item",{attrs:{label:"学号"}},[b._v(b._s(null===(l=b.currentRecord)||void 0===l?void 0:l.studentNumber))]),w("el-descriptions-item",{attrs:{label:"班级"}},[b._v(b._s(null===(o=b.currentRecord)||void 0===o?void 0:o.className))]),w("el-descriptions-item",{attrs:{label:"测试项目"}},[b._v(b._s(null===(n=b.currentRecord)||void 0===n?void 0:n.sportsItemName))]),w("el-descriptions-item",{attrs:{label:"申请原因"}},[b._v(b._s(null===(u=b.currentRecord)||void 0===u?void 0:u.reason))]),w("el-descriptions-item",{attrs:{label:"申请时间"}},[b._v(b._s(b.formatDateTime(null===(c=b.currentRecord)||void 0===c?void 0:c.applyTime)))]),w("el-descriptions-item",{attrs:{label:"状态"}},[w("el-tag",{attrs:{type:b.getStatusType(null===(d=b.currentRecord)||void 0===d?void 0:d.status)}},[b._v(" "+b._s(b.getStatusText(null===(m=b.currentRecord)||void 0===m?void 0:m.status))+" ")])],1),null!==(v=b.currentRecord)&&void 0!==v&&v.teacherReviewComment?w("el-descriptions-item",{attrs:{label:"审核意见"}},[b._v(" "+b._s(null===(p=b.currentRecord)||void 0===p?void 0:p.teacherReviewComment)+" ")]):b._e(),null!==(g=b.currentRecord)&&void 0!==g&&g.teacherReviewTime?w("el-descriptions-item",{attrs:{label:"审核时间"}},[b._v(" "+b._s(b.formatDateTime(null===(h=b.currentRecord)||void 0===h?void 0:h.teacherReviewTime))+" ")]):b._e()],1)],1)],1)},i=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"header"},[t("h2",[e._v("重测申请审核")]),t("div",{staticClass:"header-desc"},[e._v(" 审核学生提交的重测申请，可直接通过或驳回 ")])])}],s={name:"RetestReview",data(){return{loading:!1,queryParams:{keyword:"",pageNum:1,pageSize:10},total:0,tableData:[],reviewDialog:{visible:!1},detailDialog:{visible:!1},currentRecord:null,reviewForm:{status:"",comment:""},reviewRules:{status:[{required:!0,message:"请选择审核结果",trigger:"change"}],comment:[{required:!0,message:"请输入审核意见",trigger:"blur"}]}}},created(){this.getList()},methods:{async getList(){try{this.loading=!0;const e=await this.$http.get("/api/teacher/retest-applications",{params:{keyword:this.queryParams.keyword,page:this.queryParams.pageNum-1,size:this.queryParams.pageSize}});console.log("API Response:",e.data),200===e.data.code?(this.tableData=e.data.data.content,this.total=e.data.data.totalElements,console.log("Loaded data:",this.tableData)):this.$message.error(e.data.message||"获取列表失败")}catch(e){console.error("获取列表失败:",e),this.$message.error("获取列表失败")}finally{this.loading=!1}},handleQuery(){this.queryParams.pageNum=1,this.getList()},resetQuery(){this.$refs.queryForm.resetFields(),this.handleQuery()},handleReview(e){this.currentRecord=e,this.reviewForm={status:"",comment:""},this.reviewDialog.visible=!0},async submitReview(){this.$refs.reviewForm.validate(async e=>{if(e)try{const e=await this.$http.post(`/api/teacher/retest-applications/${this.currentRecord.id}/review`,{status:this.reviewForm.status,comment:this.reviewForm.comment,reviewerId:localStorage.getItem("userId")});200===e.data.code?(this.$message.success("审核成功"),this.reviewDialog.visible=!1,this.getList()):this.$message.error(e.data.message||"审核失败")}catch(t){console.error("审核失败:",t),this.$message.error("审核失败: "+t.message)}})},handleDetail(e){this.currentRecord=e,this.detailDialog.visible=!0},handleSizeChange(e){this.queryParams.pageSize=e,this.getList()},handleCurrentChange(e){this.queryParams.pageNum=e,this.getList()},formatDateTime(e){return e?new Date(e).toLocaleString():"-"},getStatusType(e){const t={PENDING:"warning",APPROVED:"success",REJECTED:"danger"};return t[e]||"info"},getStatusText(e){const t={PENDING:"待审核",APPROVED:"已通过",REJECTED:"已驳回"};return t[e]||e}}},l=s,o=(r("8e05"),r("2877")),n=Object(o["a"])(l,a,i,!1,null,"33a7da54",null);t["default"]=n.exports},b187:function(e,t,r){}}]);
//# sourceMappingURL=chunk-6177d41a.faeae434.js.map