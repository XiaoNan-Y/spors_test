{"version":3,"sources":["webpack:///./src/views/student/ExemptionApplication.vue","webpack:///src/views/student/ExemptionApplication.vue","webpack:///./src/views/student/ExemptionApplication.vue?93af","webpack:///./src/views/student/ExemptionApplication.vue?13a7","webpack:///./src/views/student/ExemptionApplication.vue?5cd2"],"names":["render","_vm$currentRecord","_vm$currentRecord2","_vm$currentRecord3","_vm$currentRecord4","_vm$currentRecord5","_vm$currentRecord6","_vm$currentRecord7","_vm$currentRecord8","_vm$currentRecord9","_vm$currentRecord10","_vm","this","_c","_self","staticClass","staticStyle","attrs","on","showDialog","_v","applications","length","scopedSlots","_u","key","fn","scope","_s","formatDateTime","row","applyTime","type","sportsItemName","attachmentUrl","$event","previewAttachment","getStatusType","status","getStatusText","adminReviewComment","teacherReviewComment","handleDelete","handleDetail","currentPage","pageSize","total","handleSizeChange","handleCurrentChange","_e","dialogVisible","ref","form","rules","handleTypeChange","model","value","callback","$$v","$set","expression","sportsItemId","_l","sportsItems","item","id","name","reason","uploadHeaders","handleUploadSuccess","handleUploadError","beforeUpload","handleRemove","fileList","slot","submitForm","detailDialogVisible","currentRecord","adminReviewTime","teacherReviewTime","staticRenderFns","data","validateAttachment","rule","Error","required","message","trigger","validator","Authorization","localStorage","getItem","methods","$delete","$nextTick","$refs","validateField","resetForm","_this$sportsItems$fin","validate","applicationData","studentId","find","apiEndpoint","response","$http","post","code","$message","success","fetchApplications","error","console","resetFields","err","file","isValidType","includes","isLt10M","size","log","exemptionResponse","retestResponse","Promise","all","get","params","page","exemptionApplications","content","retestApplications","sort","a","b","Date","totalElements","types","PENDING","APPROVED","REJECTED","texts","dateTime","toLocaleString","url","window","open","newSize","newPage","$confirm","delete","fetchSportsItems","component"],"mappings":"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","file":"js/chunk-4cff9319.61d38fa3.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"exemption-application\"},[_c('el-alert',{staticStyle:{\"margin-bottom\":\"20px\"},attrs:{\"title\":\"如果您因特殊原因需要申请免测或重测，请在此提交申请。我们会尽快处理您的申请。\",\"type\":\"info\",\"closable\":false,\"show-icon\":\"\"}}),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.showDialog}},[_vm._v(\"提交申请\")]),(_vm.applications.length)?_c('div',{staticClass:\"application-history\"},[_c('h3',[_vm._v(\"申请记录\")]),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.applications,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"prop\":\"applyTime\",\"label\":\"申请时间\",\"width\":\"180\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(_vm.formatDateTime(scope.row.applyTime))+\" \")]}}],null,false,104975167)}),_c('el-table-column',{attrs:{\"prop\":\"type\",\"label\":\"申请类型\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.type === 'EXEMPTION' ? '免测' : '重测')+\" \")]}}],null,false,3058082500)}),_c('el-table-column',{attrs:{\"prop\":\"sportsItemName\",\"label\":\"申请项目\",\"width\":\"120\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(\" \"+_vm._s(scope.row.sportsItemName || '-')+\" \")]}}],null,false,927027323)}),_c('el-table-column',{attrs:{\"prop\":\"reason\",\"label\":\"申请原因\",\"show-overflow-tooltip\":\"\"}}),_c('el-table-column',{attrs:{\"label\":\"证明材料\",\"width\":\"120\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.attachmentUrl)?_c('el-link',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.previewAttachment(scope.row.attachmentUrl)}}},[_vm._v(\" 查看附件 \")]):_c('span',[_vm._v(\"无\")])]}}],null,false,947837280)}),_c('el-table-column',{attrs:{\"prop\":\"status\",\"label\":\"状态\",\"width\":\"100\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"type\":_vm.getStatusType(scope.row.status)}},[_vm._v(\" \"+_vm._s(_vm.getStatusText(scope.row.status))+\" \")])]}}],null,false,2263538733)}),_c('el-table-column',{attrs:{\"label\":\"审核意见\",\"show-overflow-tooltip\":\"\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.adminReviewComment)?_c('div',[_vm._v(\" \"+_vm._s(scope.row.adminReviewComment)+\" \")]):(scope.row.teacherReviewComment)?_c('div',[_vm._v(\" \"+_vm._s(scope.row.teacherReviewComment)+\" \")]):_c('span',[_vm._v(\"-\")])]}}],null,false,2518471398)}),_c('el-table-column',{attrs:{\"label\":\"操作\",\"width\":\"120\",\"fixed\":\"right\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.status === 'PENDING')?_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"danger\"},on:{\"click\":function($event){return _vm.handleDelete(scope.row)}}},[_vm._v(\" 撤销 \")]):_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"info\"},on:{\"click\":function($event){return _vm.handleDetail(scope.row)}}},[_vm._v(\" 查看 \")])]}}],null,false,2423781565)})],1),_c('div',{staticClass:\"pagination-container\"},[_c('el-pagination',{attrs:{\"current-page\":_vm.currentPage,\"page-sizes\":[10, 20, 50, 100],\"page-size\":_vm.pageSize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange,\"update:currentPage\":function($event){_vm.currentPage=$event},\"update:current-page\":function($event){_vm.currentPage=$event}}})],1)],1):_vm._e(),_c('el-dialog',{attrs:{\"title\":\"提交申请\",\"visible\":_vm.dialogVisible,\"width\":\"50%\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"申请类型\",\"prop\":\"type\"}},[_c('el-radio-group',{on:{\"change\":_vm.handleTypeChange},model:{value:(_vm.form.type),callback:function ($$v) {_vm.$set(_vm.form, \"type\", $$v)},expression:\"form.type\"}},[_c('el-radio',{attrs:{\"label\":\"EXEMPTION\"}},[_vm._v(\"免测申请\")]),_c('el-radio',{attrs:{\"label\":\"RETEST\"}},[_vm._v(\"重测申请\")])],1)],1),(_vm.form.type === 'RETEST')?_c('el-form-item',{attrs:{\"label\":\"申请项目\",\"prop\":\"sportsItemId\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择申请项目\"},model:{value:(_vm.form.sportsItemId),callback:function ($$v) {_vm.$set(_vm.form, \"sportsItemId\", $$v)},expression:\"form.sportsItemId\"}},_vm._l((_vm.sportsItems),function(item){return _c('el-option',{key:item.id,attrs:{\"label\":item.name,\"value\":item.id}})}),1)],1):_vm._e(),_c('el-form-item',{attrs:{\"label\":\"申请原因\",\"prop\":\"reason\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"rows\":4,\"placeholder\":_vm.form.type === 'EXEMPTION' ? \n            '请详细说明免测申请原因，并说明相关情况' : \n            '请说明重测原因'},model:{value:(_vm.form.reason),callback:function ($$v) {_vm.$set(_vm.form, \"reason\", $$v)},expression:\"form.reason\"}})],1),(_vm.form.type === 'EXEMPTION')?_c('el-form-item',{attrs:{\"label\":\"证明材料\",\"prop\":\"attachmentUrl\",\"required\":true}},[_c('el-upload',{staticClass:\"upload-demo\",attrs:{\"action\":\"/api/upload/file\",\"headers\":_vm.uploadHeaders,\"on-success\":_vm.handleUploadSuccess,\"on-error\":_vm.handleUploadError,\"before-upload\":_vm.beforeUpload,\"on-remove\":_vm.handleRemove,\"file-list\":_vm.fileList,\"limit\":1}},[_c('el-button',{attrs:{\"size\":\"small\",\"type\":\"primary\"}},[_vm._v(\"点击上传\")]),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\" 必须上传证明材料（医院证明等），只能上传jpg/png/pdf文件，且不超过10MB \")])],1)],1):_vm._e()],1),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.submitForm}},[_vm._v(\"确 定\")])],1)],1),_c('el-dialog',{staticClass:\"detail-dialog\",attrs:{\"title\":\"申请详情\",\"visible\":_vm.detailDialogVisible,\"width\":\"600px\"},on:{\"update:visible\":function($event){_vm.detailDialogVisible=$event}}},[_c('el-descriptions',{attrs:{\"column\":1,\"border\":\"\"}},[_c('el-descriptions-item',{attrs:{\"label\":\"申请类型\"}},[_vm._v(\" \"+_vm._s(_vm.currentRecord?.type === 'EXEMPTION' ? '免测申请' : '重测申请')+\" \")]),_c('el-descriptions-item',{attrs:{\"label\":\"申请时间\"}},[_vm._v(\" \"+_vm._s(_vm.formatDateTime(_vm.currentRecord?.applyTime))+\" \")]),_c('el-descriptions-item',{attrs:{\"label\":\"申请原因\"}},[_vm._v(\" \"+_vm._s(_vm.currentRecord?.reason)+\" \")]),_c('el-descriptions-item',{attrs:{\"label\":\"证明材料\"}},[(_vm.currentRecord?.attachmentUrl)?_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.previewAttachment(_vm.currentRecord.attachmentUrl)}}},[_vm._v(\" 查看附件 \")]):_c('span',[_vm._v(\"无\")])],1),_c('el-descriptions-item',{attrs:{\"label\":\"状态\"}},[_c('el-tag',{attrs:{\"type\":_vm.getStatusType(_vm.currentRecord?.status)}},[_vm._v(\" \"+_vm._s(_vm.getStatusText(_vm.currentRecord?.status))+\" \")])],1),_c('el-descriptions-item',{attrs:{\"label\":\"审核意见\"}},[_vm._v(\" \"+_vm._s(_vm.currentRecord?.adminReviewComment || _vm.currentRecord?.teacherReviewComment || '-')+\" \")]),_c('el-descriptions-item',{attrs:{\"label\":\"审核时间\"}},[_vm._v(\" \"+_vm._s(_vm.currentRecord?.adminReviewTime ? _vm.formatDateTime(_vm.currentRecord.adminReviewTime) : (_vm.currentRecord?.teacherReviewTime ? _vm.formatDateTime(_vm.currentRecord.teacherReviewTime) : '-'))+\" \")])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"exemption-application\">\r\n    <!-- 提示信息 -->\r\n    <el-alert\r\n      title=\"如果您因特殊原因需要申请免测或重测，请在此提交申请。我们会尽快处理您的申请。\"\r\n      type=\"info\"\r\n      :closable=\"false\"\r\n      show-icon\r\n      style=\"margin-bottom: 20px;\"\r\n    />\r\n\r\n    <!-- 提交申请按钮 -->\r\n    <el-button type=\"primary\" @click=\"showDialog\">提交申请</el-button>\r\n\r\n    <!-- 申请记录表格 -->\r\n    <div class=\"application-history\" v-if=\"applications.length\">\r\n      <h3>申请记录</h3>\r\n      <el-table :data=\"applications\" border style=\"width: 100%\">\r\n        <el-table-column prop=\"applyTime\" label=\"申请时间\" width=\"180\">\r\n          <template slot-scope=\"scope\">\r\n            {{ formatDateTime(scope.row.applyTime) }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"type\" label=\"申请类型\" width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            {{ scope.row.type === 'EXEMPTION' ? '免测' : '重测' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"sportsItemName\" label=\"申请项目\" width=\"120\">\r\n          <template slot-scope=\"scope\">\r\n            {{ scope.row.sportsItemName || '-' }}\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"reason\" label=\"申请原因\" show-overflow-tooltip />\r\n        <el-table-column label=\"证明材料\" width=\"120\" align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-link \r\n              v-if=\"scope.row.attachmentUrl\"\r\n              type=\"primary\" \r\n              @click=\"previewAttachment(scope.row.attachmentUrl)\"\r\n            >\r\n              查看附件\r\n            </el-link>\r\n            <span v-else>无</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"status\" label=\"状态\" width=\"100\">\r\n          <template slot-scope=\"scope\">\r\n            <el-tag :type=\"getStatusType(scope.row.status)\">\r\n              {{ getStatusText(scope.row.status) }}\r\n            </el-tag>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"审核意见\" show-overflow-tooltip>\r\n          <template slot-scope=\"scope\">\r\n            <div v-if=\"scope.row.adminReviewComment\">\r\n              {{ scope.row.adminReviewComment }}\r\n            </div>\r\n            <div v-else-if=\"scope.row.teacherReviewComment\">\r\n              {{ scope.row.teacherReviewComment }}\r\n            </div>\r\n            <span v-else>-</span>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" width=\"120\" fixed=\"right\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n              v-if=\"scope.row.status === 'PENDING'\"\r\n              size=\"mini\"\r\n              type=\"danger\"\r\n              @click=\"handleDelete(scope.row)\"\r\n            >\r\n              撤销\r\n            </el-button>\r\n            <el-button\r\n              v-else\r\n              size=\"mini\"\r\n              type=\"info\"\r\n              @click=\"handleDetail(scope.row)\"\r\n            >\r\n              查看\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n\r\n      <!-- 分页器 -->\r\n      <div class=\"pagination-container\">\r\n        <el-pagination\r\n          @size-change=\"handleSizeChange\"\r\n          @current-change=\"handleCurrentChange\"\r\n          :current-page.sync=\"currentPage\"\r\n          :page-sizes=\"[10, 20, 50, 100]\"\r\n          :page-size=\"pageSize\"\r\n          layout=\"total, sizes, prev, pager, next, jumper\"\r\n          :total=\"total\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 申请表单对话框 -->\r\n    <el-dialog title=\"提交申请\" :visible.sync=\"dialogVisible\" width=\"50%\">\r\n      <el-form :model=\"form\" :rules=\"rules\" ref=\"form\" label-width=\"100px\">\r\n        <!-- 申请类型 -->\r\n        <el-form-item label=\"申请类型\" prop=\"type\">\r\n          <el-radio-group v-model=\"form.type\" @change=\"handleTypeChange\">\r\n            <el-radio label=\"EXEMPTION\">免测申请</el-radio>\r\n            <el-radio label=\"RETEST\">重测申请</el-radio>\r\n          </el-radio-group>\r\n        </el-form-item>\r\n\r\n        <!-- 申请项目，只在重测时显示 -->\r\n        <el-form-item \r\n          v-if=\"form.type === 'RETEST'\"\r\n          label=\"申请项目\" \r\n          prop=\"sportsItemId\"\r\n        >\r\n          <el-select v-model=\"form.sportsItemId\" placeholder=\"请选择申请项目\">\r\n            <el-option\r\n              v-for=\"item in sportsItems\"\r\n              :key=\"item.id\"\r\n              :label=\"item.name\"\r\n              :value=\"item.id\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <!-- 申请原因 -->\r\n        <el-form-item label=\"申请原因\" prop=\"reason\">\r\n          <el-input\r\n            type=\"textarea\"\r\n            v-model=\"form.reason\"\r\n            :rows=\"4\"\r\n            :placeholder=\"form.type === 'EXEMPTION' ? \r\n              '请详细说明免测申请原因，并说明相关情况' : \r\n              '请说明重测原因'\"\r\n          />\r\n        </el-form-item>\r\n\r\n        <!-- 证明材料上传 -->\r\n        <el-form-item \r\n          v-if=\"form.type === 'EXEMPTION'\"\r\n          label=\"证明材料\" \r\n          prop=\"attachmentUrl\"\r\n          :required=\"true\"\r\n        >\r\n          <el-upload\r\n            class=\"upload-demo\"\r\n            action=\"/api/upload/file\"\r\n            :headers=\"uploadHeaders\"\r\n            :on-success=\"handleUploadSuccess\"\r\n            :on-error=\"handleUploadError\"\r\n            :before-upload=\"beforeUpload\"\r\n            :on-remove=\"handleRemove\"\r\n            :file-list=\"fileList\"\r\n            :limit=\"1\"\r\n          >\r\n            <el-button size=\"small\" type=\"primary\">点击上传</el-button>\r\n            <div slot=\"tip\" class=\"el-upload__tip\">\r\n              必须上传证明材料（医院证明等），只能上传jpg/png/pdf文件，且不超过10MB\r\n            </div>\r\n          </el-upload>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n        <el-button type=\"primary\" @click=\"submitForm\">确 定</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n    <!-- 详情对话框 -->\r\n    <el-dialog\r\n      title=\"申请详情\"\r\n      :visible.sync=\"detailDialogVisible\"\r\n      width=\"600px\"\r\n      class=\"detail-dialog\"\r\n    >\r\n      <el-descriptions :column=\"1\" border>\r\n        <el-descriptions-item label=\"申请类型\">\r\n          {{ currentRecord?.type === 'EXEMPTION' ? '免测申请' : '重测申请' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"申请时间\">\r\n          {{ formatDateTime(currentRecord?.applyTime) }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"申请原因\">\r\n          {{ currentRecord?.reason }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"证明材料\">\r\n          <el-button \r\n            v-if=\"currentRecord?.attachmentUrl\"\r\n            type=\"text\" \r\n            @click=\"previewAttachment(currentRecord.attachmentUrl)\"\r\n          >\r\n            查看附件\r\n          </el-button>\r\n          <span v-else>无</span>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"状态\">\r\n          <el-tag :type=\"getStatusType(currentRecord?.status)\">\r\n            {{ getStatusText(currentRecord?.status) }}\r\n          </el-tag>\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"审核意见\">\r\n          {{ currentRecord?.adminReviewComment || currentRecord?.teacherReviewComment || '-' }}\r\n        </el-descriptions-item>\r\n        <el-descriptions-item label=\"审核时间\">\r\n          {{ currentRecord?.adminReviewTime ? \r\n            formatDateTime(currentRecord.adminReviewTime) : \r\n            (currentRecord?.teacherReviewTime ? \r\n              formatDateTime(currentRecord.teacherReviewTime) : '-') }}\r\n        </el-descriptions-item>\r\n      </el-descriptions>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'ExemptionApplication',\r\n  data() {\r\n    // 自定义验证规则：免测申请必须上传附件\r\n    const validateAttachment = (rule, value, callback) => {\r\n      if (this.form.type === 'EXEMPTION' && !this.form.attachmentUrl) {\r\n        callback(new Error('免测申请必须上传证明材料'));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n\r\n    return {\r\n      dialogVisible: false,\r\n      form: {\r\n        type: 'EXEMPTION',\r\n        reason: '',\r\n        attachmentUrl: '',\r\n        sportsItemId: null\r\n      },\r\n      rules: {\r\n        type: [{ required: true, message: '请选择申请类型' }],\r\n        reason: [{ required: true, message: '请填写申请原因', trigger: 'blur' }],\r\n        attachmentUrl: [{ validator: validateAttachment, trigger: 'change' }],\r\n        sportsItemId: [{ required: true, message: '请选择申请项目' }]\r\n      },\r\n      applications: [],\r\n      fileList: [],\r\n      uploadHeaders: {\r\n        Authorization: 'Bearer ' + localStorage.getItem('token')\r\n      },\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n      total: 0,\r\n      sportsItems: [], // 体育项目列表\r\n      detailDialogVisible: false, // 添加这个控制详情对话框的显示\r\n      currentRecord: null, // 当前查看的记录\r\n    }\r\n  },\r\n  methods: {\r\n    handleTypeChange(value) {\r\n      // 重置表单相关字段\r\n      this.form.attachmentUrl = '';\r\n      this.form.sportsItemId = null;\r\n      this.fileList = [];\r\n\r\n      // 重新设置验证规则\r\n      if (value === 'RETEST') {\r\n        this.$set(this.rules, 'sportsItemId', [\r\n          { required: true, message: '请选择申请项目', trigger: 'change' }\r\n        ]);\r\n      } else {\r\n        // 免测时移除体育项目的验证规则\r\n        this.$delete(this.rules, 'sportsItemId');\r\n      }\r\n\r\n      // 重新验证表单\r\n      this.$nextTick(() => {\r\n        this.$refs.form.validateField('attachmentUrl');\r\n      });\r\n    },\r\n    showDialog() {\r\n      this.dialogVisible = true;\r\n      this.resetForm();\r\n    },\r\n    async submitForm() {\r\n      try {\r\n        await this.$refs.form.validate();\r\n        \r\n        // 构造申请数据\r\n        const applicationData = {\r\n          ...this.form,\r\n          studentId: localStorage.getItem('userId'),\r\n          // 根据申请类型设置不同的API路径\r\n          type: this.form.type, // 确保type正确传递\r\n          sportsItemId: this.form.type === 'RETEST' ? this.form.sportsItemId : null,\r\n          sportsItemName: this.form.type === 'RETEST' ? \r\n            this.sportsItems.find(item => item.id === this.form.sportsItemId)?.name : null\r\n        };\r\n\r\n        // 根据申请类型选择不同的API端点\r\n        const apiEndpoint = this.form.type === 'RETEST' ? \r\n          '/api/exemptions/student/submit-retest' : \r\n          '/api/exemptions/student/submit';\r\n\r\n        const response = await this.$http.post(apiEndpoint, applicationData);\r\n\r\n        if (response.data.code === 200) {\r\n          this.$message.success('提交成功');\r\n          this.dialogVisible = false;\r\n          this.fetchApplications();\r\n        }\r\n      } catch (error) {\r\n        console.error('提交失败:', error);\r\n        this.$message.error('提交失败: ' + error.message);\r\n      }\r\n    },\r\n    resetForm() {\r\n      if (this.$refs.form) {\r\n        this.$refs.form.resetFields();\r\n      }\r\n      this.fileList = [];\r\n      this.form.attachmentUrl = '';\r\n    },\r\n    handleUploadSuccess(response) {\r\n      if (response.code === 200) {\r\n        this.form.attachmentUrl = response.data;\r\n        this.$message.success('上传成功');\r\n      } else {\r\n        this.$message.error(response.message || '上传失败');\r\n      }\r\n    },\r\n    handleUploadError(err) {\r\n      console.error('上传失败:', err);\r\n      this.$message.error('上传失败: ' + (err.message || '未知错误'));\r\n    },\r\n    handleRemove() {\r\n      this.form.attachmentUrl = '';\r\n      this.fileList = [];\r\n    },\r\n    beforeUpload(file) {\r\n      const isValidType = ['image/jpeg', 'image/png', 'application/pdf'].includes(file.type);\r\n      const isLt10M = file.size / 1024 / 1024 < 10;\r\n\r\n      if (!isValidType) {\r\n        this.$message.error('只能上传JPG/PNG/PDF文件!');\r\n        return false;\r\n      }\r\n      if (!isLt10M) {\r\n        this.$message.error('文件大小不能超过10MB!');\r\n        return false;\r\n      }\r\n      return true;\r\n    },\r\n    async fetchApplications() {\r\n      try {\r\n        console.log('Fetching applications for user:', localStorage.getItem('userId'));\r\n        \r\n        // 修改请求路径，使用相对路径\r\n        const [exemptionResponse, retestResponse] = await Promise.all([\r\n          this.$http.get('/api/exemptions/student/list', {\r\n            params: {\r\n              studentId: localStorage.getItem('userId'),\r\n              page: this.currentPage - 1,\r\n              size: this.pageSize\r\n            }\r\n          }),\r\n          this.$http.get('/api/exemptions/retest-applications/student/list', { // 修改这里的路径\r\n            params: {\r\n              studentId: localStorage.getItem('userId'),\r\n              page: this.currentPage - 1,\r\n              size: this.pageSize\r\n            }\r\n          })\r\n        ]);\r\n\r\n        if (exemptionResponse.data.code === 200 && retestResponse.data.code === 200) {\r\n          // 合并两种申请记录\r\n          const exemptionApplications = exemptionResponse.data.data.content || [];\r\n          const retestApplications = retestResponse.data.data.content || [];\r\n          \r\n          // 合并并按申请时间排序\r\n          this.applications = [...exemptionApplications, ...retestApplications]\r\n            .sort((a, b) => new Date(b.applyTime) - new Date(a.applyTime));\r\n          \r\n          // 计算总记录数\r\n          this.total = exemptionResponse.data.data.totalElements + \r\n                      retestResponse.data.data.totalElements;\r\n          \r\n          console.log('Loaded applications:', this.applications);\r\n          console.log('Total records:', this.total);\r\n        } else {\r\n          this.$message.error('获取申请记录失败');\r\n        }\r\n      } catch (error) {\r\n        console.error('获取申请记录失败:', error);\r\n        this.$message.error('获取申请记录失败: ' + error.message);\r\n      }\r\n    },\r\n    getStatusType(status) {\r\n      const types = {\r\n        PENDING: 'warning',\r\n        APPROVED: 'success',\r\n        REJECTED: 'danger'\r\n      };\r\n      return types[status] || 'info';\r\n    },\r\n    getStatusText(status) {\r\n      const texts = {\r\n        PENDING: '待审核',\r\n        APPROVED: '已通过',\r\n        REJECTED: '已驳回'\r\n      };\r\n      return texts[status] || status;\r\n    },\r\n    formatDateTime(dateTime) {\r\n      if (!dateTime) return '-';\r\n      return new Date(dateTime).toLocaleString();\r\n    },\r\n    previewAttachment(url) {\r\n      if (!url) return;\r\n      window.open(url, '_blank');\r\n    },\r\n    handleSizeChange(newSize) {\r\n      this.pageSize = newSize;\r\n      this.fetchApplications();\r\n    },\r\n    handleCurrentChange(newPage) {\r\n      this.currentPage = newPage;\r\n      this.fetchApplications();\r\n    },\r\n    async handleDelete(row) {\r\n      try {\r\n        await this.$confirm('确认撤销该申请吗？', '提示', {\r\n          type: 'warning'\r\n        });\r\n        \r\n        const response = await this.$http.delete(`/api/exemptions/student/${row.id}`, {\r\n          params: {\r\n            studentId: localStorage.getItem('userId')\r\n          }\r\n        });\r\n        \r\n        if (response.data.code === 200) {\r\n          this.$message.success('撤销成功');\r\n          this.fetchApplications(); // 刷新列表\r\n        } else {\r\n          this.$message.error(response.data.message || '撤销失败');\r\n        }\r\n      } catch (error) {\r\n        if (error !== 'cancel') {\r\n          console.error('撤销申请失败:', error);\r\n          this.$message.error('撤销失败: ' + error.message);\r\n        }\r\n      }\r\n    },\r\n    handleDetail(row) {\r\n      this.currentRecord = row;\r\n      this.detailDialogVisible = true;\r\n    },\r\n    // 获取体育项目列表\r\n    async fetchSportsItems() {\r\n      try {\r\n        const response = await this.$http.get('/api/sports-items/student/list');\r\n        if (response.data.code === 200) {\r\n          this.sportsItems = response.data.data;\r\n        }\r\n      } catch (error) {\r\n        console.error('获取体育项目列表失败:', error);\r\n        this.$message.error('获取体育项目列表失败');\r\n      }\r\n    }\r\n  },\r\n  async created() {\r\n    // 确保在组件创建时获取数据\r\n    await this.fetchApplications();\r\n    await this.fetchSportsItems();\r\n    \r\n    // 添加调试日志\r\n    console.log('Component created, applications:', this.applications);\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.exemption-application {\r\n  padding: 20px;\r\n}\r\n\r\n.application-history {\r\n  margin-top: 30px;\r\n}\r\n\r\n.el-upload {\r\n  width: 100%;\r\n}\r\n\r\n.upload-demo {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.el-upload__tip {\r\n  line-height: 1.5;\r\n  color: #666;\r\n}\r\n\r\n.pagination-container {\r\n  margin-top: 20px;\r\n  text-align: right;\r\n}\r\n\r\n.detail-dialog {\r\n  .el-descriptions {\r\n    margin: 20px 0;\r\n  }\r\n  \r\n  .el-descriptions-item__label {\r\n    width: 120px;\r\n    color: #606266;\r\n  }\r\n  \r\n  .el-descriptions-item__content {\r\n    color: #303133;\r\n  }\r\n}\r\n</style> ","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExemptionApplication.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExemptionApplication.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./ExemptionApplication.vue?vue&type=template&id=7bb87b70&scoped=true\"\nimport script from \"./ExemptionApplication.vue?vue&type=script&lang=js\"\nexport * from \"./ExemptionApplication.vue?vue&type=script&lang=js\"\nimport style0 from \"./ExemptionApplication.vue?vue&type=style&index=0&id=7bb87b70&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7bb87b70\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ExemptionApplication.vue?vue&type=style&index=0&id=7bb87b70&prod&scoped=true&lang=css\""],"sourceRoot":""}